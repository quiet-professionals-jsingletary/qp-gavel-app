{"version":3,"sources":["../node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js","../node_modules/@arcgis/core/layers/graphics/sources/FeatureLayerSource.js"],"names":["i","t","renderer","type","symbol","e","n","o","s","r","indexOf","JSON","stringify","Function","u","name","description","prototype","attributes","q","Set","I","arguments","signal","this","addResolvingPromise","_fetchService","d","layer","capabilities","query","supportsFormatPBF","parsedUrl","a","dynamicDataSource","gdbVersion","spatialReference","fieldsIndex","F","url","path","format","sourceSpatialReference","load","objectIdField","_getLayerRequestOptions","_getFormDataForAttachment","p","body","_createFeatureEditResult","data","addAttachmentResult","_createAttachmentErrorResult","attachmentId","updateAttachmentResult","addFeatures","map","_serializeFeature","updateFeatures","_getFeatureIds","deleteFeatures","g","deleteAttachments","addAttachments","_serializeAttachment","push","updateAttachments","length","adds","updates","deletes","l","method","join","rollbackOnFailure","rollbackOnFailureEnabled","useGlobalIds","globalIdUsed","attachments","_createEditsResult","attachmentIds","deleteAttachmentResults","then","returnUpdates","layerId","id","extent","fullExtent","timeExtent","y","fromJSON","f","start","end","get","objectIds","c","parentObjectId","attachmentInfos","b","queryTask","executeAttachmentQuery","execute","customParameters","executeJSON","executeForIds","executeForCount","executeForExtent","executeRelationshipQuery","executeRelationshipQueryForCount","sourceJSON","returnAdvancedSymbols","_patchServiceJSON","has","geometryType","drawingInfo","defaultSymbol","R","geometry","toJSON","feature","attachment","globalId","contentType","uploadId","parentGlobalId","globalIdField","h","FileReader","readAsDataURL","onload","result","onerror","mediaType","File","_getIdsFromFeatureIdentifier","_getIdsFromFeatures","objectId","addFeatureResults","addResults","updateFeatureResults","updateResults","deleteFeatureResults","deleteResults","addAttachmentResults","updateAttachmentResults","success","error","code","details","messages","message","httpStatus","messageCode","FormData","elements","set","append","source","responseType","m","constructOnly","readOnly","dependsOn","_"],"mappings":"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","file":"static/js/52.cbfbdefb.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as r}from\"../../../../core/lang.js\";import{defaultPointSymbolJSON as e,defaultPolylineSymbolJSON as n,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function i(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?e:\"esriGeometryPolyline\"===t?n:o}}}function s(r,e){if(t(\"csp-restrictions\"))return()=>({[e]:null,...r});try{let t=`this.${e} = null;`;for(const e in r){t+=`this${e.indexOf(\".\")?`[\"${e}\"]`:`.${e}`} = ${JSON.stringify(r[e])};`}const n=new Function(t);return()=>new n}catch(t){return()=>({[e]:null,...r})}}function u(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:r(t)}}]}export{s as createDefaultAttributesFunction,u as createDefaultTemplate,i as createDrawingInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/has.js\";import{fixJson as r}from\"../../../core/lang.js\";import{setDeepValue as a}from\"../../../core/object.js\";import{isSome as s,isNone as o}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as u}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../core/Error.js\";import{dataComponents as l}from\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{resolve as d,all as c,create as h}from\"../../../core/promiseUtils.js\";import y from\"../../../geometry/Extent.js\";import p from\"../../../request.js\";import m from\"../../../core/Loadable.js\";import f from\"../../../TimeExtent.js\";import{unapplyEditsZUnitScaling as g}from\"../../../tasks/operations/zscale.js\";import{processAttachmentQueryResult as b}from\"../../../tasks/operations/queryAttachments.js\";import F from\"../../../tasks/QueryTask.js\";import{createDrawingInfo as R}from\"./support/clientSideDefaults.js\";const q=new Set([\"Feature Layer\",\"Table\"]);let I=class extends m{constructor(){super(...arguments),this.type=\"feature-layer\"}load(e){const t=s(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),d(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:e}},parsedUrl:r,dynamicDataSource:a,gdbVersion:s,spatialReference:o,fieldsIndex:i}=this.layer,u=t(\"featurelayer-pbf\")&&e?\"pbf\":\"json\";return new F({url:r.path,format:u,fieldsIndex:i,dynamicDataSource:a,gdbVersion:s,sourceSpatialReference:o})}async addAttachment(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/addAttachment\",s=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,s.query);try{const e=await p(a,{body:o});return this._createFeatureEditResult(e.data.addAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}async updateAttachment(e,t,r){await this.load();const a=e.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+\"/\"+a+\"/updateAttachment\",o=this._getLayerRequestOptions({query:{attachmentId:t}}),i=this._getFormDataForAttachment(r,o.query);try{const e=await p(s,{body:i});return this._createFeatureEditResult(e.data.updateAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(a,e)}}async applyEdits(e,t){await this.load();const r=e.addFeatures.map(this._serializeFeature,this),a=e.updateFeatures.map(this._serializeFeature,this),s=this._getFeatureIds(e.deleteFeatures);g(r,a,this.layer.spatialReference);const o=[],i=[],u=[...e.deleteAttachments];for(const t of e.addAttachments)o.push(await this._serializeAttachment(t));for(const t of e.updateAttachments)i.push(await this._serializeAttachment(t));const n=o.length||i.length||u.length?{adds:o,updates:i,deletes:u}:null,l=this._getLayerRequestOptions({method:\"post\",query:{adds:r.length?JSON.stringify(r):null,updates:a.length?JSON.stringify(a):null,deletes:s.length?s.join(\",\"):null,gdbVersion:null==t?void 0:t.gdbVersion,rollbackOnFailure:null==t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:null==t?void 0:t.globalIdUsed,attachments:n&&JSON.stringify(n)}}),d=await p(this.layer.parsedUrl.path+\"/applyEdits\",l);return this._createEditsResult(d)}async deleteAttachments(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/deleteAttachments\";try{return(await p(a,this._getLayerRequestOptions({query:{attachmentIds:t.join(\",\")},method:\"post\"}))).data.deleteAttachmentResults.map(this._createFeatureEditResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}fetchRecomputedExtents(e={}){const t=e.signal;return this.load({signal:t}).then((async()=>{const t=this._getLayerRequestOptions({...e,query:{returnUpdates:!0}}),{layerId:r,url:a}=this.layer,{data:s}=await p(`${a}/${r}`,t),{id:o,extent:i,fullExtent:u,timeExtent:n}=s,l=i||u;return{id:o,fullExtent:l&&y.fromJSON(l),timeExtent:n&&f.fromJSON({start:n[0],end:n[1]})}}))}async queryAttachments(e,t={}){const{parsedUrl:r}=this.layer,a=r.path;await this.load();const s=this._getLayerRequestOptions(t);if(!this.layer.get(\"capabilities.operations.supportsQueryAttachments\")){const{objectIds:t}=e,r=[];for(const e of t){const t=a+\"/\"+e+\"/attachments\";r.push(p(t,s))}return c(r).then((e=>t.map(((t,r)=>({parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}))))).then((e=>b(e,a)))}return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){return await this.load(),this.queryTask.execute(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async _fetchService(e){let r=this.layer.sourceJSON;if(!r){const{data:a}=await p(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:t(\"featurelayer-advanced-symbols\")?{returnAdvancedSymbols:!0}:{},signal:e}));r=a}this.sourceJSON=this._patchServiceJSON(r);const a=r.type;if(!q.has(a))throw new n(\"feature-layer-source:unsupported-type\",`Source type \"${a}\" is not supported`)}_patchServiceJSON(e){var t;if(\"Table\"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){const t=R(e.geometryType).renderer;a(\"drawingInfo.renderer\",t,e)}return e}_serializeFeature(e){const{geometry:t,attributes:r}=e;return o(t)?{attributes:r}:\"mesh\"===t.type||\"extent\"===t.type?null:{geometry:t.toJSON(),attributes:r}}async _serializeAttachment(e){const{feature:t,attachment:r}=e,{globalId:a,name:s,contentType:o,data:i,uploadId:u}=r,n={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(n.parentGlobalId=\"attributes\"in t?t.attributes&&t.attributes[this.layer.globalIdField]:t.globalId),u)n.uploadId=u;else if(i){const e=await async function(e){if(\"string\"==typeof e){return l(e)||{data:e}}return h(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(l(a.result)),a.onerror=e=>r(e)}))}(i);n.contentType=e.mediaType,n.data=e.data,i instanceof File&&(n.name=i.name)}return s&&(n.name=s),o&&(n.contentType=o),n}_getFeatureIds(e){const t=e[0];return t?\"objectId\"in t?this._getIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}_getIdsFromFeatures(e){const t=this.layer.objectIdField;return e.map((e=>e.attributes&&e.attributes[t]))}_getIdsFromFeatureIdentifier(e){return e.map((e=>e.objectId))}_createEditsResult(e){const t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new n(\"feature-layer-source:edit-failure\",t.description,{code:t.code}):null}}_createAttachmentErrorResult(e,t){const r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new n(\"feature-layer-source:attachment-failure\",r,{code:a})}}_getFormDataForAttachment(e,t){const r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(const e in t){const a=t[e];null!=a&&(r.set?r.set(e,a):r.append(e,a))}return r}_getLayerRequestOptions(e={}){const{parsedUrl:t,gdbVersion:a,dynamicDataSource:s}=this.layer;return{...e,query:r({gdbVersion:a,layer:s?JSON.stringify({source:s}):void 0,...t.query,f:\"json\",...this.layer.customParameters,...null==e?void 0:e.query}),responseType:\"json\"}}};e([i()],I.prototype,\"type\",void 0),e([i({constructOnly:!0})],I.prototype,\"layer\",void 0),e([i({readOnly:!0,dependsOn:[\"layer.parsedUrl\",\"layer.gdbVersion\",\"layer.dynamicDataSource\",\"layer.fieldsIndex\"]})],I.prototype,\"queryTask\",null),I=e([u(\"esri.layers.graphics.sources.FeatureLayerSource\")],I);var _=I;export default _;\n"],"sourceRoot":""}