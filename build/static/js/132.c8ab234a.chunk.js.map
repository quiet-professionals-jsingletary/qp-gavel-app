{"version":3,"sources":["../node_modules/@arcgis/core/symbols/cim/TextRasterizer.js","../node_modules/@arcgis/core/symbols/cim/CIMSymbolRasterizer.js","../node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js","../node_modules/@arcgis/core/symbols/cim/Rasterizer.js"],"names":["r","t","this","_textRasterizationCanvas","document","createElement","o","n","getContext","setFontProperties","parameters","textLines","split","lineHeight","computeLineHeight","a","computeTextWidth","h","length","width","height","renderedLineHeight","Math","round","pixelRatio","renderedHaloSize","halo","size","renderedWidth","renderedHeight","fillStyle","slice","toString","i","color","haloStyle","e","l","d","c","s","textAlign","g","f","p","renderHalo","globalCompositeOperation","fillText","u","getImageData","x","Uint8Array","data","premultiplyColors","image","Uint32Array","buffer","sdf","simplePattern","anchorX","anchorY","_haloRasterizationCanvas","clearRect","strokeStyle","lineJoin","renderHaloEmulated","renderHaloNative","globalAlpha","drawImage","lineWidth","strokeText","font","style","weight","family","textBaseline","horizontalAlignment","max","measureText","push","cos","PI","sin","Legend","Preview","targetSize","frame","xmax","xmin","ymax","ymin","referenceSize","scaleFactor","M","fill","legend","geometry","rings","canvasPaths","preview","stroke","paths","I","Object","keys","map","name","alias","type","z","symbol","P","materialHash","cim","materialOverrides","analyzedCIM","hash","_spatialReference","_avoidSDF","_resourceCache","Map","_rasterizer","y","_textRasterizer","_pictureMarkerCache","centroid","analyzeCIMSymbol","attributes","rasterizeCIMSymbol","geometryType","spatialReference","fields","fetchPictureMarkerResource","text","indexOf","textCase","Promise","all","get","url","responseType","signal","set","_getRasterizedResource","m","offsetX","offsetY","rotation","rotateClockwise","angle","verticalAlignment","rotateClockWise","rasterizedResource","getSymbolImage","C","min","createImageData","Uint8ClampedArray","rasterizedImage","_imageDataToCanvas","save","translate","rotate","restore","imageData","anchorPosition","_imageDataCanvas","putImageData","_getPictureResource","_rasterizePictureResource","_embedCIMLayerInVectorMarker","markerPlacement","JSON","stringify","rasterizeJSONResource","_rasterizeTextResource","anchorPoint","preserveOutlineWidth","has","window","devicePixelRatio","fontName","decoration","outlineColor","outlineSize","rasterizeText","abs","createPattern","setTransform","m11","m12","m21","m22","m41","m42","beginPath","moveTo","lineTo","closePath","apply","_imageTo32Array","markerGraphics","symbolLayers","maxSize","node","opacity","cimOptions","feature","fieldMap","clone","rasterizeCIMSymbolAsync","b","w","D","scale","ceil","Image","src","toDataURL","appendChild","_rasterizationCanvas","rasterizeSimpleFill","rasterizeSimpleLine","cap","fromSimpleMarker","fromCIMHatchFill","fromCIMInsidePolygon","rasterize","ImageData","setAttribute","oldColor","newColor"],"mappings":"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","file":"static/js/132.c8ab234a.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{pt2px as t}from\"../../core/screenUtils.js\";function e(t){return`rgb(${t.slice(0,3).toString()})`}function i(t){return`rgba(${t.slice(0,3).toString()},${t[3]})`}class r{constructor(){}rasterizeText(t,r){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement(\"canvas\"));const o=this._textRasterizationCanvas,n=o.getContext(\"2d\");this.setFontProperties(n,r),this.parameters=r,this.textLines=t.split(/\\r?\\n/),this.lineHeight=this.computeLineHeight();const a=this.computeTextWidth(n,r),h=this.lineHeight*this.textLines.length;o.width=a,o.height=h,this.renderedLineHeight=Math.round(this.lineHeight*r.pixelRatio),this.renderedHaloSize=r.halo.size*r.pixelRatio,this.renderedWidth=a*r.pixelRatio,this.renderedHeight=h*r.pixelRatio,this.fillStyle=i(r.color),this.haloStyle=e(r.halo.color);const l=this.renderedLineHeight,d=this.renderedHaloSize;this.setFontProperties(n,r);const c=s(n.textAlign,this.renderedWidth)+d,g=d;let f=0,p=0;d>0&&this.renderHalo(n,c,g,f,p,r),p+=g,f+=c;for(const e of this.textLines)n.globalCompositeOperation=\"destination-out\",n.fillStyle=\"rgb(0, 0, 0)\",n.fillText(e,f,p),n.globalCompositeOperation=\"source-over\",n.fillStyle=this.fillStyle,n.fillText(e,f,p),p+=l;const u=n.getImageData(0,0,this.renderedWidth,this.renderedHeight),x=new Uint8Array(u.data);if(r.premultiplyColors){let t;for(let e=0;e<x.length;e+=4)t=x[e+3]/255,x[e]=x[e]*t,x[e+1]=x[e+1]*t,x[e+2]=x[e+2]*t}return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(x.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}renderHalo(t,e,i,r,s,o){const n=this.renderedWidth,a=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement(\"canvas\")),this._haloRasterizationCanvas.width=n,this._haloRasterizationCanvas.height=a;const h=this._haloRasterizationCanvas,l=h.getContext(\"2d\");l.clearRect(0,0,n,a),this.setFontProperties(l,o),l.fillStyle=this.haloStyle,l.strokeStyle=this.haloStyle;const d=this.renderedHaloSize<3;l.lineJoin=d?\"miter\":\"round\",d?this.renderHaloEmulated(l,e,i):this.renderHaloNative(l,e,i),t.globalAlpha=this.parameters.halo.color[3],t.drawImage(h,0,0,n,a,r,s,n,a),t.globalAlpha=1}renderHaloEmulated(t,e,i){const r=this.renderedLineHeight,s=this.renderedHaloSize;for(const n of this.textLines){for(const[r,a]of o)t.fillText(n,e+s*r,i+s*a);i+=r}}renderHaloNative(t,e,i){const r=this.renderedLineHeight,s=this.renderedHaloSize;for(const o of this.textLines){const n=2*s,a=5,h=.1;for(let r=0;r<a;r++){const s=1-(a-1)*h+r*h;t.lineWidth=s*n,t.strokeText(o,e,i)}i+=r}}setFontProperties(e,i){const r=i.font,s=`${r.style} ${r.weight} ${t(i.size*i.pixelRatio)}px ${r.family}, sans-serif`;let o;switch(e.font=s,e.textBaseline=\"top\",i.horizontalAlignment){case\"left\":o=\"left\";break;case\"right\":o=\"right\";break;case\"center\":o=\"center\";break;default:o=\"left\"}e.textAlign=o}computeTextWidth(t,e){let i=0;for(const s of this.textLines)i=Math.max(i,t.measureText(s).width);const r=e.font;return(\"italic\"===r.style||\"oblique\"===r.style||\"string\"==typeof r.weight&&(\"bold\"===r.weight||\"bolder\"===r.weight)||\"number\"==typeof r.weight&&r.weight>600)&&(i+=.3*t.measureText(\"A\").width),i+=2*this.parameters.halo.size,Math.round(i)}computeLineHeight(){const t=1.275*this.parameters.size;return Math.round(t+2*this.parameters.halo.size)}}function s(t,e){return\"center\"===t?.5*e:\"right\"===t?e:0}const o=[];{const t=16;for(let e=0;e<360;e+=360/t)o.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}export default r;export{r as TextRasterizer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{numericHash as e}from\"../../core/string.js\";import{throwIfAborted as t}from\"../../core/promiseUtils.js\";import{getJsonType as r,isPolygon as a,isPolyline as i}from\"../../geometry/support/jsonUtils.js\";import{pt2px as s}from\"../../core/screenUtils.js\";import o from\"../support/Symbol3DAnchorPosition2D.js\";import n from\"../../request.js\";import{createLabelOverrideFunction as c,evaluateValueOrFunction as l,colorToArray as m}from\"./utils.js\";import{scaleCIMMarker as h}from\"../support/cimSymbolUtils.js\";import{analyzeCIMSymbol as f,analyzeCIMResource as g}from\"./cimAnalyzer.js\";import y from\"./Rasterizer.js\";import{TextRasterizer as u}from\"./TextRasterizer.js\";var p;!function(e){e.Legend=\"legend\",e.Preview=\"preview\"}(p||(p={}));const d=(e,t,r)=>{if(e&&e.targetSize){let a;if(r){const t=Math.max(r.frame.xmax-r.frame.xmin,r.frame.ymax-r.frame.ymin);a=e.targetSize/s(t)}else a=e.targetSize/t.referenceSize;return a}return e&&e.scaleFactor?e.scaleFactor:1},M={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};class C{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._rasterizer=new y,this._textRasterizer=new u,this._pictureMarkerCache=new Map}async rasterizeCIMSymbolAsync(e,t,a,i,s,o,n,c){i=i||(t?null!=t.centroid?\"esriGeometryPolygon\":r(t.geometry):null)||z(e);const l=await this.analyzeCIMSymbol(e,t?I(t.attributes):null,a,i,c);return this.rasterizeCIMSymbol(l,t,i,s,o,n)}async analyzeCIMSymbol(e,r,a,i,s){const o=[],n=r?{geometryType:i,spatialReference:this._spatialReference,fields:r}:null;let l;await f(e.data,n,o,this._avoidSDF),t(s);for(const t of o)\"CIMPictureMarker\"!==t.cim.type&&\"CIMPictureFill\"!==t.cim.type&&\"CIMPictureStroke\"!==t.cim.type||(l||(l=[]),l.push(this.fetchPictureMarkerResource(t,s))),a&&\"text\"===t.type&&\"string\"==typeof t.text&&t.text.indexOf(\"[\")>-1&&(t.text=c(a,t.text,t.cim.textCase));return l&&await Promise.all(l),o}async fetchPictureMarkerResource(e,t){const r=e.materialHash;if(!this._pictureMarkerCache.get(r)){const a=(await n(e.cim.url,{responseType:\"image\",signal:t&&t.signal})).data;this._pictureMarkerCache.set(r,a)}}rasterizeCIMSymbol(e,t,r,a,i,s){const o=[];for(const n of e){a&&\"function\"==typeof a.scaleFactor&&(a.scaleFactor=a.scaleFactor(t,i,s));const e=this._getRasterizedResource(n,t,r,a,i,s);if(!e)continue;let c=0,m=e.anchorX||0,h=e.anchorY||0,f=!1,g=0,y=0;if(\"esriGeometryPoint\"===r){const e=d(a,n,null);if(g=l(n.offsetX,t,i,s)*e||0,y=l(n.offsetY,t,i,s)*e||0,\"marker\"===n.type)c=l(n.rotation,t,i,s)||0,f=!!n.rotateClockwise&&n.rotateClockwise;else if(\"text\"===n.type){if(c=l(n.angle,t,i,s)||0,void 0!==n.horizontalAlignment)switch(n.horizontalAlignment){case\"left\":m=-.5;break;case\"right\":m=.5;break;default:m=0}if(void 0!==n.verticalAlignment)switch(n.verticalAlignment){case\"top\":h=.5;break;case\"bottom\":h=-.5;break;case\"baseline\":h=-.25;break;default:h=0}}}null!=e&&o.push({angle:c,rotateClockWise:f,anchorX:m,anchorY:h,offsetX:g,offsetY:y,rasterizedResource:e})}return this.getSymbolImage(o)}getSymbolImage(e){const t=document.createElement(\"canvas\"),r=t.getContext(\"2d\");let a=0,i=0,n=0,c=0;const l=[];for(let o=0;o<e.length;o++){const t=e[o],m=t.rasterizedResource;if(!m)continue;const h=m.size,f=t.offsetX,g=t.offsetY,y=t.anchorX,u=t.anchorY,p=t.rotateClockWise||!1;let d=t.angle,M=s(f)-h[0]*(.5+y),C=s(g)-h[1]*(.5+u),I=M+h[0],z=C+h[1];if(d){p&&(d=-d);const e=Math.sin(d*Math.PI/180),t=Math.cos(d*Math.PI/180),r=M*t-C*e,a=M*e+C*t,i=M*t-z*e,s=M*e+z*t,o=I*t-z*e,n=I*e+z*t,c=I*t-C*e,l=I*e+C*t;M=Math.min(r,i,o,c),C=Math.min(a,s,n,l),I=Math.max(r,i,o,c),z=Math.max(a,s,n,l)}a=M<a?M:a,i=C<i?C:i,n=I>n?I:n,c=z>c?z:c;const P=r.createImageData(m.size[0],m.size[1]);P.data.set(new Uint8ClampedArray(m.image.buffer));const x={offsetX:f,offsetY:g,rotateClockwise:p,angle:d,rasterizedImage:P,anchorX:y,anchorY:u};l.push(x)}t.width=n-a,t.height=c-i;const m=-a,h=c;for(let o=0;o<l.length;o++){const e=l[o],t=this._imageDataToCanvas(e.rasterizedImage),a=e.rasterizedImage.width,i=e.rasterizedImage.height,n=m-a*(.5+e.anchorX),c=h-i*(.5-e.anchorY);if(e.angle){const a=(360-e.angle)*Math.PI/180;r.save(),r.translate(s(e.offsetX),-s(e.offsetY)),r.translate(m,h),r.rotate(a),r.translate(-m,-h),r.drawImage(t,n,c),r.restore()}else r.drawImage(t,n+s(e.offsetX),c-s(e.offsetY))}const f=new o({x:m/t.width-.5,y:h/t.height-.5});return{imageData:0!==t.width&&0!==t.height?r.getImageData(0,0,t.width,t.height):r.createImageData(1,1),anchorPosition:f}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement(\"canvas\"));const t=this._imageDataCanvas,r=t.getContext(\"2d\");return t.width=e.width,t.height=e.height,r.putImageData(e,0,0),t}_imageTo32Array(e,t,r){this._imageDataCanvas||(this._imageDataCanvas=document.createElement(\"canvas\"));const a=this._imageDataCanvas,i=a.getContext(\"2d\");return a.width=t,a.height=r,i.drawImage(e,0,0,t,r),new Uint32Array(i.getImageData(0,0,t,r).data.buffer)}_getRasterizedResource(t,r,a,i,s,o){let n,c,m,f;if(\"esriGeometryPolyline\"===a||\"esriGeometryPolygon\"===a){const h=i&&i.style?i.style:p.Legend,f=\"esriGeometryPolyline\"===a?M.stroke[h]:M.fill[h];if(\"line\"===t.type){if(\"CIMSolidStroke\"!==t.cim.type){if(\"CIMPictureStroke\"===t.cim.type){const e=l(t.width,r,s,o),{image:a,width:i,height:n}=this._getPictureResource(t,e);return this._rasterizePictureResource(t,a,i,n,f,e)}return null}({analyzedCIM:n,hash:m}=P(t,r,s,o)),c=this._embedCIMLayerInVectorMarker(n,f)}else if(\"marker\"===t.type){if(\"CIMPictureMarker\"===t.cim.type)return null;if(\"CIMVectorMarker\"!==t.cim.type)return null;t.cim.offsetX=l(t.offsetX,r,s,o),t.cim.offsetY=l(t.offsetY,r,s,o),t.cim.rotation=l(t.rotation,r,s,o),t.cim.markerPlacement=t.markerPlacement,({analyzedCIM:n}=P(t,r,s,o)),m=e(JSON.stringify(n)).toString(),c=this._embedCIMLayerInVectorMarker(n,f)}else{if(\"text\"===t.type)return null;if(\"fill\"===t.type){if(\"CIMHatchFill\"===t.cim.type||\"CIMVectorMarker\"===t.cim.type||\"CIMPictureMarker\"===t.cim.type||\"CIMPictureFill\"===t.cim.type){const e=t.cim.size||t.cim.height;let a,i,c;if(\"CIMPictureMarker\"===t.cim.type||\"CIMPictureFill\"===t.cim.type)({image:a,width:i,height:c}=this._getPictureResource(t,e));else{({analyzedCIM:n,hash:m}=P(t,r,s,o));const e=this._rasterizer.rasterizeJSONResource(n,1,this._avoidSDF);a=e.image,i=e.size[0],c=e.size[1]}return this._rasterizePictureResource(t,a,i,c,f,null)}if(\"CIMSolidFill\"!==t.cim.type)return null;({analyzedCIM:n,hash:m}=P(t,r,s,o)),c=this._embedCIMLayerInVectorMarker(n,f)}}}else{if(\"text\"===t.type)return f=this._rasterizeTextResource(t,r,i,s,o),f;({analyzedCIM:n,hash:m}=P(t,r,s,o));const e=d(i,t,null);if(\"CIMPictureMarker\"===t.cim.type){const a=l(t.size,r,s,o)*e,{image:i,width:n,height:c}=this._getPictureResource(t,a);return f={image:i,size:[n,c],sdf:!1,simplePattern:!1,anchorX:t.anchorPoint?t.anchorPoint.x:0,anchorY:t.anchorPoint?t.anchorPoint.y:0},f}h(n,e,{preserveOutlineWidth:!1}),c=n}m+=a,i&&(m+=JSON.stringify(i));const g=this._resourceCache;return g.has(m)?g.get(m):(f=this._rasterizer.rasterizeJSONResource(c,window.devicePixelRatio||1,this._avoidSDF),g.set(m,f),f)}_rasterizeTextResource(e,t,r,a,i){const s=d(r,e,null),o=l(e.text,t,a,i);if(!o||0===o.length)return null;const n=l(e.fontName,t,a,i),c=l(e.style,t,a,i),h=l(e.weight,t,a,i),f=l(e.decoration,t,a,i),g=l(e.size,t,a,i)*s,y=l(e.horizontalAlignment,t,a,i),u=l(e.verticalAlignment,t,a,i),p=m(l(e.color,t,a,i)),M=m(l(e.outlineColor,t,a,i)),C={color:p,size:g,horizontalAlignment:y,verticalAlignment:u,font:{family:n,style:c,weight:h,decoration:f},halo:{size:l(e.outlineSize,t,a,i)||0,color:M,style:c},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(o,C)}_rasterizePictureResource(e,t,r,o,n,c){const l=document.createElement(\"canvas\"),m=l.getContext(\"2d\");l.height=s(Math.max(Math.abs(n.frame.ymax-n.frame.ymin),c)),l.width=s(Math.abs(n.frame.xmax-n.frame.xmin));const h=m.createImageData(r,o);h.data.set(new Uint8ClampedArray(t.buffer));const f=this._imageDataToCanvas(h),g=m.createPattern(f,\"repeat\"),y=Math.cos((-e.cim.rotation||0)*Math.PI/180),u=Math.sin((-e.cim.rotation||0)*Math.PI/180);g.setTransform({m11:y,m12:u,m21:-u,m22:y,m41:s(e.cim.offsetX)||0,m42:s(e.cim.offsetY)||0});const p=n.canvasPaths;let d,M,C;a(p)?(d=p.rings,m.fillStyle=g,M=m.fill,C=[\"evenodd\"]):i(p)&&(d=p.paths,m.strokeStyle=g,m.lineWidth=c,M=m.stroke,d[0][0][1]=l.height/2,d[0][1][1]=l.height/2),m.beginPath();for(const a of d){const e=a?a.length:0;if(e>1){let t=a[0];m.moveTo(s(t[0]),s(t[1]));for(let r=1;r<e;++r)t=a[r],m.lineTo(s(t[0]),s(t[1]));m.closePath()}}M.apply(m,C);const I=m.getImageData(0,0,l.width,l.height),z=new Uint8Array(I.data);return{size:[l.width,l.height],image:new Uint32Array(z.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(e,t){const r=this._pictureMarkerCache.get(e.materialHash);if(!r)return null;const a=r.height/r.width,i=t?a>1?s(t):s(t)/a:r.width,o=t?a>1?s(t)*a:s(t):r.height;return{image:this._imageTo32Array(r,i,o),width:i,height:o}}_embedCIMLayerInVectorMarker(e,t){const r=a(t.geometry)?\"CIMPolygonSymbol\":\"CIMLineSymbol\";return{type:\"CIMVectorMarker\",frame:t.frame,markerGraphics:[{type:\"CIMMarkerGraphic\",geometry:t.geometry,symbol:{type:r,symbolLayers:[e]}}]}}}function I(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:\"string\"==typeof e[t]?\"esriFieldTypeString\":\"esriFieldTypeDouble\"})))}function z(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case\"CIMPointSymbol\":case\"CIMTextSymbol\":return\"esriGeometryPoint\";case\"CIMLineSymbol\":return\"esriGeometryPolyline\";case\"CIMPolygonSymbol\":return\"esriGeometryPolygon\";default:return null}}function P(e,t,r,a){let i,s;if(\"function\"==typeof e.materialHash){i=(0,e.materialHash)(t,r,a),s=g(e.cim,e.materialOverrides)}else i=e.materialHash,s=e.cim;return{analyzedCIM:s,hash:i}}export{C as CIMSymbolRasterizer,p as GeometryStyle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{px2pt as t}from\"../../core/screenUtils.js\";import{getCIMSymbolSize as e,scaleCIMSymbolTo as a}from\"./cimSymbolUtils.js\";import{CIMSymbolRasterizer as l}from\"../cim/CIMSymbolRasterizer.js\";const i=new l(null,!0),o=120;async function n(l,n={}){const{size:s,maxSize:c,node:m,opacity:r}=n,y=n.cimOptions||n,{feature:d,fieldMap:h,geometryType:p,style:u}=y,g=e(l),f=Math.min(null!=s?s:g,null!=c?c:t(o));f!==g&&(l=l.clone(),a(l,f,{preserveOutlineWidth:!0}));let M=3;l&&l.data&&l.data.symbol&&\"CIMPointSymbol\"!==l.data.symbol.type&&(M=1);const b=await i.rasterizeCIMSymbolAsync(l,d,h,p,{scaleFactor:M,style:u}),w=document.createElement(\"canvas\");w.width=b.imageData.width,w.height=b.imageData.height;w.getContext(\"2d\").putImageData(b.imageData,0,0);let C=w.width/M,D=w.height/M;if(null!=s&&(null==(null==n?void 0:n.scale)||(null==n?void 0:n.scale))){const t=C/D;C=t<=1?Math.ceil(f*t):f,D=t<=1?f:Math.ceil(f/t)}const I=new Image(C,D);return I.src=w.toDataURL(),null!=r&&(I.style.opacity=`${r}`),m&&m.appendChild(I),I}export{n as previewCIMSymbol};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{resampleHermite as e}from\"./utils.js\";import r from\"./Rect.js\";import{SymbolHelper as t,CIMSymbolHelper as a}from\"./CIMSymbolHelper.js\";import{getSDFInfo as n,buildSDF as i}from\"./SDFHelper.js\";const s=512;class o{dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(e,s,o){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement(\"canvas\")),\"simple-fill\"===e.type||\"esriSFS\"===e.type){const[r,a,n]=t.rasterizeSimpleFill(this._rasterizationCanvas,e.style,s);return{size:[a,n],image:new Uint32Array(r.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if(\"simple-line\"===e.type||\"esriSLS\"===e.type){const[r,a,n]=t.rasterizeSimpleLine(e.style,e.cap);return{size:[a,n],image:new Uint32Array(r.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let m,l,f;if(\"simple-marker\"===e.type||\"esriSMS\"===e.type||\"line-marker\"===e.type?(m=a.fromSimpleMarker(e),f=n(m)):\"CIMHatchFill\"===e.type?(m=a.fromCIMHatchFill(e),l=new r(m.frame.xmin,-m.frame.ymax,m.frame.xmax-m.frame.xmin,m.frame.ymax-m.frame.ymin)):e.markerPlacement&&\"CIMMarkerPlacementInsidePolygon\"===e.markerPlacement.type?(m=a.fromCIMInsidePolygon(e),l=new r(m.frame.xmin,-m.frame.ymax,m.frame.xmax-m.frame.xmin,m.frame.ymax-m.frame.ymin)):(m=e,f=n(m)),f&&!o){const[e,r,t]=i(f);return e?{size:[r,t],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[c,h,p,y,u]=a.rasterize(this._rasterizationCanvas,m,l,!o);return c?{size:[h,p],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:y,anchorY:u}:null}rasterizeImageResource(r,t,a,n){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement(\"canvas\")),this._rasterizationCanvas.width=r,this._rasterizationCanvas.height=t;const i=this._rasterizationCanvas.getContext(\"2d\");a instanceof ImageData?i.putImageData(a,0,0):(a.setAttribute(\"width\",`${r}px`),a.setAttribute(\"height\",`${t}px`),i.drawImage(a,0,0,r,t));const o=i.getImageData(0,0,r,t),m=new Uint8Array(o.data);if(n)for(const e of n)if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){const[r,t,a,n]=e.oldColor,[i,s,o,l]=e.newColor;if(r===i&&t===s&&a===o&&n===l)continue;for(let e=0;e<m.length;e+=4)r===m[e]&&t===m[e+1]&&a===m[e+2]&&n===m[e+3]&&(m[e]=i,m[e+1]=s,m[e+2]=o,m[e+3]=l)}let l;for(let e=0;e<m.length;e+=4)l=m[e+3]/255,m[e]=m[e]*l,m[e+1]=m[e+1]*l,m[e+2]=m[e+2]*l;let f=m,c=r,h=t;const p=s;if(c>=p||h>=p){const a=c/h;a>1?(c=p,h=Math.round(p/a)):(h=p,c=Math.round(p*a)),f=new Uint8Array(4*c*h);const n=new Uint8ClampedArray(f.buffer);e(m,r,t,n,c,h,!1)}return{size:[r,t],image:new Uint32Array(f.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}export default o;\n"],"sourceRoot":""}