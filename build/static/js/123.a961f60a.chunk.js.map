{"version":3,"sources":["../node_modules/@arcgis/core/layers/MapNotesLayer.js","../node_modules/@arcgis/core/layers/graphics/objectIdUtils.js"],"names":["F","e","layers","some","layerDefinition","visibilityField","G","T","name","alias","type","nullable","editable","_","P","arguments","visibilityMode","this","graphics","sourceLayer","layer","on","item","E","l","readOnly","prototype","s","k","geometryType","geometryTypeJSON","layerId","title","identifyingSymbol","g","toJSON","d","b","S","z","capabilities","operations","supportsMapNotesEditing","featureCollections","featureCollectionJSON","featureCollectionType","legendEnabled","minScale","maxScale","spatialReference","u","WGS84","sublayers","f","map","id","t","r","origin","o","R","read","items","featureCollection","length","c","xmin","ymin","xmax","ymax","fromJSON","reduce","extent","union","_findSublayer","featureSet","a","i","n","find","drawingInfo","renderer","symbol","features","geometry","attributes","popupInfo","h","popupTemplate","push","p","_writeMapNoteSublayer","m","messages","y","addResolvingPromise","loadFromPortal","supportedTypes","Promise","resolve","Object","assign","w","N","L","v","x","forEach","_writeMapNote","_normalizeObjectIds","objectIdField","fields","graphic","D","Set","has","add","C","I","J","M","j","O","json","origins","write","enabled","target","ignoreOrigin","overridePolicy","Number","nonNullable","value","B","isFinite","Math","max"],"mappings":"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","file":"static/js/123.a961f60a.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import{clone as t}from\"../core/lang.js\";import{setDeepValue as r}from\"../core/object.js\";import{isNone as o,isSome as i}from\"../core/maybe.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as l}from\"../core/accessorSupport/decorators/property.js\";import{reader as a}from\"../core/accessorSupport/decorators/reader.js\";import n from\"../core/Warning.js\";import{subclass as s}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as p}from\"../core/accessorSupport/decorators/writer.js\";import y from\"../core/Error.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{equals as m}from\"../geometry/support/spatialReferenceUtils.js\";import u from\"../geometry/SpatialReference.js\";import c from\"../geometry/Extent.js\";import\"../geometry.js\";import f from\"../core/Collection.js\";import d from\"../symbols/SimpleLineSymbol.js\";import g from\"../symbols/SimpleFillSymbol.js\";import b from\"../symbols/SimpleMarkerSymbol.js\";import S from\"../symbols/TextSymbol.js\";import\"../symbols.js\";import h from\"../Graphic.js\";import O from\"./Layer.js\";import{MultiOriginJSONMixin as j}from\"../core/MultiOriginJSONSupport.js\";import{canProjectWithoutEngine as w,isLoaded as N,load as L,project as v}from\"../geometry/projection.js\";import{OperationalLayer as J}from\"./mixins/OperationalLayer.js\";import{normalizeCentralMeridian as x}from\"../geometry/support/normalizeUtils.js\";import T from\"./support/Field.js\";import{BlendLayer as C}from\"./mixins/BlendLayer.js\";import{PortalLayer as M}from\"./mixins/PortalLayer.js\";import{ScaleRangeLayer as I}from\"./mixins/ScaleRangeLayer.js\";import R from\"./FeatureLayer.js\";import E from\"./GraphicsLayer.js\";import{findLastObjectIdFromFeatures as D}from\"./graphics/objectIdUtils.js\";function F(e){return e.layers.some((e=>null!=e.layerDefinition.visibilityField))}const G=new T({name:\"OBJECTID\",alias:\"OBJECTID\",type:\"oid\",nullable:!1,editable:!1}),_=new T({name:\"title\",alias:\"Title\",type:\"string\",nullable:!0,editable:!0});let P=class extends E{constructor(){super(...arguments),this.visibilityMode=\"inherited\"}initialize(){for(const e of this.graphics)e.sourceLayer=this.layer;this.graphics.on(\"after-add\",(e=>{e.item.sourceLayer=this.layer})),this.graphics.on(\"after-remove\",(e=>{e.item.sourceLayer=null}))}get sublayers(){return this.graphics}};e([l({readOnly:!0})],P.prototype,\"sublayers\",null),e([l()],P.prototype,\"layer\",void 0),e([l({readOnly:!0})],P.prototype,\"visibilityMode\",void 0),P=e([s(\"esri.layers.MapNotesLayer.MapNotesSublayer\")],P);const k=[{geometryType:\"polygon\",geometryTypeJSON:\"esriGeometryPolygon\",layerId:\"polygonLayer\",title:\"Polygons\",identifyingSymbol:(new g).toJSON()},{geometryType:\"polyline\",geometryTypeJSON:\"esriGeometryPolyline\",layerId:\"polylineLayer\",title:\"Polylines\",identifyingSymbol:(new d).toJSON()},{geometryType:\"multipoint\",geometryTypeJSON:\"esriGeometryMultipoint\",layerId:\"multipointLayer\",title:\"Multipoints\",identifyingSymbol:(new b).toJSON()},{geometryType:\"point\",geometryTypeJSON:\"esriGeometryPoint\",layerId:\"pointLayer\",title:\"Points\",identifyingSymbol:(new b).toJSON()},{geometryType:\"point\",geometryTypeJSON:\"esriGeometryPoint\",layerId:\"textLayer\",title:\"Text\",identifyingSymbol:(new S).toJSON()}];let z=class extends(C(I(J(M(j(O)))))){constructor(e){super(e),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType=\"notes\",this.legendEnabled=!1,this.minScale=0,this.maxScale=0,this.spatialReference=u.WGS84,this.sublayers=new f(k.map((e=>new P({id:e.layerId,title:e.title,layer:this})))),this.title=\"Map Notes\",this.type=\"map-notes\",this.visibilityMode=\"inherited\"}readCapabilities(e,t,r){return{operations:{supportsMapNotesEditing:!F(t)&&\"portal-item\"!==(null==r?void 0:r.origin)}}}readFeatureCollections(e,t,r){if(!F(t))return null;const o=t.layers.map((e=>{const t=new R;return t.read(e,r),t}));return new f({items:o})}readLegacyfeatureCollectionJSON(e,r){return F(r)?t(r.featureCollection):null}readFullExtent(e,t){if(!t.layers.length)return new c({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:u.WGS84});const r=u.fromJSON(t.layers[0].layerDefinition.spatialReference);return t.layers.reduce(((e,t)=>{const r=t.layerDefinition.extent;return r?c.fromJSON(r).union(e):e}),new c({spatialReference:r}))}readMinScale(e,t){for(const r of t.layers)if(null!=r.layerDefinition.minScale)return r.layerDefinition.minScale;return 0}readMaxScale(e,t){for(const r of t.layers)if(null!=r.layerDefinition.maxScale)return r.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer(\"multipointLayer\")}get pointLayer(){return this._findSublayer(\"pointLayer\")}get polygonLayer(){return this._findSublayer(\"polygonLayer\")}get polylineLayer(){return this._findSublayer(\"polylineLayer\")}readSpatialReference(e,t){return t.layers.length?u.fromJSON(t.layers[0].layerDefinition.spatialReference):u.WGS84}readSublayers(e,t,r){if(F(t))return null;const o=[];for(let l=0;l<t.layers.length;l++){var i;const{layerDefinition:e,featureSet:r}=t.layers[l],a=null!=(i=e.geometryType)?i:r.geometryType,n=k.find((t=>{var r,o,i;return a===t.geometryTypeJSON&&(null==(r=e.drawingInfo)||null==(o=r.renderer)||null==(i=o.symbol)?void 0:i.type)===t.identifyingSymbol.type}));if(n){const t=new P({id:n.layerId,title:e.name,layer:this,graphics:r.features.map((({geometry:e,symbol:t,attributes:r,popupInfo:o})=>h.fromJSON({attributes:r,geometry:e,symbol:t,popupTemplate:o})))});o.push(t)}}return new f(o)}writeSublayers(e,t,l,a){const{minScale:n,maxScale:s}=this;if(o(e))return;const p=e.some((e=>e.graphics.length>0));if(!this.capabilities.operations.supportsMapNotesEditing){var m;if(p)null==a||null==(m=a.messages)||m.push(new y(\"map-notes-layer:editing-not-supported\",\"New map notes cannot be added to this layer\"));return}const u=[];let c=this.spatialReference.toJSON();e:for(const r of e)for(const e of r.graphics)if(i(e.geometry)){c=e.geometry.spatialReference.toJSON();break e}for(const r of k){const t=e.find((e=>r.layerId===e.id));this._writeMapNoteSublayer(u,t,r,n,s,c,a)}r(\"featureCollection.layers\",u,t)}get textLayer(){return this._findSublayer(\"textLayer\")}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Feature Collection\"]},e)),Promise.resolve(this)}read(e,r){\"featureCollection\"in e&&(e=t(e),Object.assign(e,e.featureCollection)),super.read(e,r)}async beforeSave(){if(o(this.sublayers))return;let e=null;const t=[];for(const o of this.sublayers)for(const r of o.graphics)if(i(r.geometry)){const o=r.geometry;e?m(o.spatialReference,e)||(w(o.spatialReference,e)||N()||await L(),r.geometry=v(o,e)):e=o.spatialReference,t.push(r)}const r=await x(t.map((e=>e.geometry)));t.forEach(((e,t)=>e.geometry=r[t]))}_findSublayer(e){var t,r;return o(this.sublayers)?null:null!=(t=null==(r=this.sublayers)?void 0:r.find((t=>t.id===e)))?t:null}_writeMapNoteSublayer(e,r,i,l,a,n,s){const p=[];if(!o(r)){for(const e of r.graphics)this._writeMapNote(p,e,i.geometryType,s);this._normalizeObjectIds(p,G),e.push({layerDefinition:{name:r.title,drawingInfo:{renderer:{type:\"simple\",symbol:t(i.identifyingSymbol)}},geometryType:i.geometryTypeJSON,minScale:l,maxScale:a,objectIdField:\"OBJECTID\",fields:[G.toJSON(),_.toJSON()],spatialReference:n},featureSet:{features:p,geometryType:i.geometryTypeJSON}})}}_writeMapNote(e,t,r,l){if(o(t))return;const{geometry:a,symbol:s,popupTemplate:p}=t;if(o(a))return;var y,m;if(a.type!==r)return void(null==l||null==(y=l.messages)||y.push(new n(\"map-notes-layer:invalid-geometry-type\",`Geometry \"${a.type}\" cannot be saved in \"${r}\" layer`,{graphic:t})));if(o(s))return void(null==l||null==(m=l.messages)||m.push(new n(\"map-notes-layer:no-symbol\",\"Skipping map notes with no symbol\",{graphic:t})));const u={attributes:{...t.attributes},geometry:a.toJSON(),symbol:s.toJSON()};i(p)&&(u.popupInfo=p.toJSON()),e.push(u)}_normalizeObjectIds(e,t){const r=t.name;let o=D(r,e)+1;const i=new Set;for(const l of e){l.attributes||(l.attributes={});const{attributes:e}=l;(null==e[r]||i.has(e[r]))&&(e[r]=o++),i.add(e[r])}}};e([l({readOnly:!0})],z.prototype,\"capabilities\",void 0),e([a([\"portal-item\",\"web-map\"],\"capabilities\",[\"layers\"])],z.prototype,\"readCapabilities\",null),e([l({readOnly:!0})],z.prototype,\"featureCollections\",void 0),e([a([\"web-map\",\"portal-item\"],\"featureCollections\",[\"layers\"])],z.prototype,\"readFeatureCollections\",null),e([l({readOnly:!0,json:{origins:{\"web-map\":{write:{enabled:!0,target:\"featureCollection\"}}}}})],z.prototype,\"featureCollectionJSON\",void 0),e([a([\"web-map\",\"portal-item\"],\"featureCollectionJSON\",[\"featureCollection\"])],z.prototype,\"readLegacyfeatureCollectionJSON\",null),e([l({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],z.prototype,\"featureCollectionType\",void 0),e([l({json:{write:!1}})],z.prototype,\"fullExtent\",void 0),e([a([\"web-map\",\"portal-item\"],\"fullExtent\",[\"layers\"])],z.prototype,\"readFullExtent\",null),e([l({readOnly:!0,json:{origins:{\"web-map\":{write:{target:\"featureCollection.showLegend\",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],z.prototype,\"legendEnabled\",void 0),e([l({type:[\"show\",\"hide\"]})],z.prototype,\"listMode\",void 0),e([l({type:Number,nonNullable:!0,json:{write:!1}})],z.prototype,\"minScale\",void 0),e([a([\"web-map\",\"portal-item\"],\"minScale\",[\"layers\"])],z.prototype,\"readMinScale\",null),e([l({type:Number,nonNullable:!0,json:{write:!1}})],z.prototype,\"maxScale\",void 0),e([a([\"web-map\",\"portal-item\"],\"maxScale\",[\"layers\"])],z.prototype,\"readMaxScale\",null),e([l({readOnly:!0})],z.prototype,\"multipointLayer\",null),e([l({value:\"ArcGISFeatureLayer\",type:[\"ArcGISFeatureLayer\"]})],z.prototype,\"operationalLayerType\",void 0),e([l({readOnly:!0})],z.prototype,\"pointLayer\",null),e([l({readOnly:!0})],z.prototype,\"polygonLayer\",null),e([l({readOnly:!0})],z.prototype,\"polylineLayer\",null),e([l({type:u})],z.prototype,\"spatialReference\",void 0),e([a([\"web-map\",\"portal-item\"],\"spatialReference\",[\"layers\"])],z.prototype,\"readSpatialReference\",null),e([l({readOnly:!0,json:{origins:{\"web-map\":{write:{ignoreOrigin:!0}}}}})],z.prototype,\"sublayers\",void 0),e([a(\"web-map\",\"sublayers\",[\"layers\"])],z.prototype,\"readSublayers\",null),e([p(\"web-map\",\"sublayers\")],z.prototype,\"writeSublayers\",null),e([l({readOnly:!0})],z.prototype,\"textLayer\",null),e([l()],z.prototype,\"title\",void 0),e([l({readOnly:!0,json:{read:!1}})],z.prototype,\"type\",void 0),z=e([s(\"esri.layers.MapNotesLayer\")],z);var B=z;export default B;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nconst t=1;function n(t,n){let o=0;for(const r of n){var e;const n=null==(e=r.attributes)?void 0:e[t];\"number\"==typeof n&&isFinite(n)&&(o=Math.max(o,n))}return o}export{n as findLastObjectIdFromFeatures,t as initialObjectId};\n"],"sourceRoot":""}