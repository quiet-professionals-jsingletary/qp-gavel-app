(this["webpackJsonpqp-ampd-app"]=this["webpackJsonpqp-ampd-app"]||[]).push([[7],{764:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(8),i=r.n(n),a=(r(31),r(22)),s=r(16),u=r(68),c=r(10),o=r(12),l=r(21),h=r(15),f=r(40),p=r(36),d=r(65),m=r(122),v=r(121),y=r(11),b=r(9),g=r(182),x=(r(86),r(58));function O(e,t,r,n){return j.apply(this,arguments)}function j(){return(j=Object(a.a)(i.a.mark((function e(t,r,n,a){var s,u,c,o,l,h,f,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="string"==typeof t?Object(b.I)(t):t,u=r[0].spatialReference,c=Object(y.a)(Object(y.a)({},a),{},{query:Object(y.a)(Object(y.a)({},s.query),{},{f:"json",sr:JSON.stringify(u),target:JSON.stringify({geometryType:Object(g.c)(r[0]),geometries:r}),cutter:JSON.stringify(n)})}),e.next=5,Object(x.default)(s.path+"/cut",c);case 5:return o=e.sent,l=o.data,h=l.cutIndexes,f=l.geometries,p=void 0===f?[]:f,e.abrupt("return",{cutIndexes:h,geometries:p.map((function(e){var t=Object(g.a)(e);return t.spatialReference=u,t}))});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t,r){return I.apply(this,arguments)}function I(){return(I=Object(a.a)(i.a.mark((function e(t,r,n){var a,s,u,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?Object(b.I)(t):t,s=r[0].spatialReference,u=Object(g.c)(r[0]),c=Object(y.a)(Object(y.a)({},n),{},{query:Object(y.a)(Object(y.a)({},a.query),{},{f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify(w(r))})}),e.t0=function(e,t,r){var n=Object(g.b)(t);return e.map((function(e){var t=n.fromJSON(e);return t.spatialReference=r,t}))},e.next=4,Object(x.default)(a.path+"/simplify",c);case 4:return e.t1=e.sent.data,e.t2=u,e.t3=s,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return{geometryType:Object(g.c)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}var S=o.a.getLogger("esri.geometry.support.normalizeUtils"),M={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new v.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:p.a.WebMercator}),minus180Line:new v.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:p.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new v.a({paths:[[[180,-180],[180,180]]],spatialReference:p.a.WGS84}),minus180Line:new v.a({paths:[[[-180,-180],[-180,180]]],spatialReference:p.a.WGS84})}};function k(e){return"polygon"===e.type}function R(e){return"polyline"===e[0].type}function F(e){return k(e)?e.rings:e.paths}function N(e,t){return Math.ceil((e-t)/(2*t))}function A(e,t){var r,n=F(e),i=Object(s.a)(n);try{for(i.s();!(r=i.n()).done;){var a,u=r.value,c=Object(s.a)(u);try{for(c.s();!(a=c.n()).done;){a.value[0]+=t}}catch(o){c.e(o)}finally{c.f()}}}catch(o){i.e(o)}finally{i.f()}return e}function T(e,t,r){if(t){var n=function(e,t){if(!(e instanceof v.a||e instanceof m.a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw S.error(r),new l.a(r)}var n,i=F(e),a=[],u=Object(s.a)(i);try{for(u.s();!(n=u.n()).done;){var c=n.value,o=[];a.push(o),o.push([c[0][0],c[0][1]]);for(var h=0;h<c.length-1;h++){var f=c[h][0],p=c[h][1],d=c[h+1][0],y=c[h+1][1],b=Math.sqrt((d-f)*(d-f)+(y-p)*(y-p)),g=(y-p)/b,x=(d-f)/b,O=b/t;if(O>1){for(var j=1;j<=O-1;j++){var _=j*t,I=x*_+f,w=g*_+p;o.push([I,w])}var M=(b+Math.floor(O-1)*t)/2,R=x*M+f,N=g*M+p;o.push([R,N])}o.push([d,y])}}}catch(A){u.e(A)}finally{u.f()}return k(e)?new m.a({rings:a,spatialReference:e.spatialReference}):new v.a({paths:a,spatialReference:e.spatialReference})}(e,1e6);e=Object(d.e)(n,!0)}return r&&(e=A(e,r)),e}function Q(e,t,r){if(Array.isArray(e)){var n=e[0];if(n>t){var i=N(n,t);e[0]=n+i*(-2*t)}else if(n<r){var a=N(n,r);e[0]=n+a*(-2*r)}}else{var s=e.x;if(s>t){var u=N(s,t);e=e.clone().offset(u*(-2*t),0)}else if(s<r){var c=N(s,r);e=e.clone().offset(c*(-2*r),0)}}return e}function E(e,t,r){return P.apply(this,arguments)}function P(){return(P=Object(a.a)(i.a.mark((function e(t,r,n){var a,o,l,p,y,b,g,x,j,I,w,S,k,P,G,C,Y,B,q,V,X,D,z,Z,L,J,U,W,H,$,K,ee,te,re,ne,ie,ae,se,ue,ce;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",E([t],r));case 2:a=r?r.url:u.a.geometryServiceUrl,I=0,w=[],S=[],k=Object(s.a)(t);try{for(k.s();!(P=k.n()).done;)G=P.value,Object(c.f)(G)?S.push(G):(o||(o=G.spatialReference,l=Object(f.d)(o),p=o.isWebMercator,y=M[g=p?102100:4326].maxX,b=M[g].minX,x=M[g].plus180Line,j=M[g].minus180Line),l?"mesh"===G.type?S.push(G):"point"===G.type?S.push(Q(G.clone(),y,b)):"multipoint"===G.type?((C=G.clone()).points=C.points.map((function(e){return Q(e,y,b)})),S.push(C)):"extent"===G.type?(Y=G.clone()._normalize(!1,!1,l),S.push(Y.rings?new m.a(Y):Y)):G.extent?(B=G.extent,q=N(B.xmin,b)*(2*y),V=0===q?G.clone():A(G.clone(),q),B.offset(q,0),B.intersects(x)&&B.xmax!==y?(I=B.xmax>I?B.xmax:I,V=T(V,p),w.push(V),S.push("cut")):B.intersects(j)&&B.xmin!==b?(I=B.xmax*(2*y)>I?B.xmax*(2*y):I,V=T(V,p,360),w.push(V),S.push("cut")):S.push(V)):S.push(G.clone()):S.push(G))}catch(i){k.e(i)}finally{k.f()}for(X=N(I,y),D=-90,z=X,Z=new v.a;X>0;)L=360*X-180,Z.addPath([[L,D],[L,-1*D]]),D*=-1,X--;if(!(w.length>0&&z>0)){e.next=28;break}return e.t0=function(e,t){for(var r=-1,n=function(n){for(var a=t.cutIndexes[n],u=t.geometries[n],c=F(u),o=function(e){var t=c[e];t.some((function(r){if(r[0]<180)return!0;for(var n=0,i=0;i<t.length;i++){var a=t[i][0];n=a>n?a:n}for(var s=-360*N(n=Number(n.toFixed(9)),180),c=0;c<t.length;c++){var o=u.getPoint(e,c);u.setPoint(e,c,o.clone().offset(s,0))}return!0}))},l=0;l<c.length;l++)o(l);if(a===r){if("polygon"===e[0].type){var h,f=Object(s.a)(F(u));try{for(f.s();!(h=f.n()).done;){var p=h.value;e[a]=e[a].addRing(p)}}catch(i){f.e(i)}finally{f.f()}}else if(R(e)){var d,m=Object(s.a)(F(u));try{for(m.s();!(d=m.n()).done;){var v=d.value;e[a]=e[a].addPath(v)}}catch(i){m.e(i)}finally{m.f()}}}else r=a,e[a]=u},a=0;a<t.cutIndexes.length;a++)n(a);return e},e.t1=w,e.next=15,O(a,w,Z,n);case 15:for(e.t2=e.sent,J=(0,e.t0)(e.t1,e.t2),U=[],W=[],H=0;H<S.length;H++)"cut"!==($=S[H])?W.push($):(K=J.shift(),ee=t[H],Object(c.g)(ee)&&"polygon"===ee.type&&ee.rings&&ee.rings.length>1&&K.rings.length>=ee.rings.length?(U.push(K),W.push("simplify")):W.push(p?Object(d.b)(K):K));if(U.length){e.next=22;break}return e.abrupt("return",W);case 22:return e.next=24,_(a,U,n);case 24:for(te=e.sent,re=[],ne=0;ne<W.length;ne++)"simplify"!==(ie=W[ne])?re.push(ie):re.push(p?Object(d.b)(te.shift()):te.shift());return e.abrupt("return",re);case 28:for(ae=[],se=0;se<S.length;se++)"cut"!==(ue=S[se])?ae.push(ue):(ce=w.shift(),ae.push(!0===p?Object(d.b)(ce):ce));return e.abrupt("return",Object(h.s)(ae));case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},768:function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return u})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return a})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return d})),r.d(t,"l",(function(){return p})),r.d(t,"m",(function(){return f}));var n=r(10);r(57),r(108);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;return[e[0],e[1],e[2],e[3],e[4],e[5]]}function a(e,t,r,n,a,s){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i();return u[0]=e,u[1]=t,u[2]=r,u[3]=n,u[4]=a,u[5]=s,u}function s(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function u(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function c(e,t,r){var n=t.length,i=e[0],a=e[1],s=e[2],u=e[3],c=e[4],o=e[5];if(r)for(var l=0;l<n;l++){var h=t[l];i=Math.min(i,h[0]),a=Math.min(a,h[1]),s=Math.min(s,h[2]),u=Math.max(u,h[0]),c=Math.max(c,h[1]),o=Math.max(o,h[2])}else for(var f=0;f<n;f++){var p=t[f];i=Math.min(i,p[0]),a=Math.min(a,p[1]),u=Math.max(u,p[0]),c=Math.max(c,p[1])}e[0]=i,e[1]=a,e[2]=s,e[3]=u,e[4]=c,e[5]=o}function o(e){return e[0]>=e[3]?0:e[3]-e[0]}function l(e){return e[1]>=e[4]?0:e[4]-e[1]}function h(e){return e[2]>=e[5]?0:e[5]-e[2]}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=o(e),t[1]=l(e),t[2]=h(e),t}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function m(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function v(e){return e?m(e,x):i(x)}function y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function b(e){return 6===e.length}function g(e,t,r){if(Object(n.f)(e)||Object(n.f)(t))return e===t;if(!b(e)||!b(t))return!1;if(r){for(var i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var x=[1/0,1/0,1/0,-1/0,-1/0,-1/0],O=[0,0,0,0,0,0];i()},787:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return w}));var n=r(8),i=r.n(n),a=r(2),s=r(3),u=r(22),c=r(16),o=r(31),l=r(15),h=r(40),f=r(65),p=r(142),d=r(808),m=[0,0];function v(e,t){if(!t)return null;if("x"in t){var r,n,i={x:0,y:0};return r=e(t.x,t.y,m),n=Object(o.a)(r,2),i.x=n[0],i.y=n[1],null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){var a,s,u,c,l={xmin:0,ymin:0,xmax:0,ymax:0};return a=e(t.xmin,t.ymin,m),s=Object(o.a)(a,2),l.xmin=s[0],l.ymin=s[1],u=e(t.xmax,t.ymax,m),c=Object(o.a)(u,2),l.xmax=c[0],l.ymax=c[1],t.hasZ&&(l.zmin=t.zmin,l.zmax=t.zmax,l.hasZ=!0),t.hasM&&(l.mmin=t.mmin,l.mmax=t.mmax,l.hasM=!0),l}return"rings"in t?{rings:y(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:y(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:b(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function y(e,t){var r,n=[],i=Object(c.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(b(a,t))}}catch(s){i.e(s)}finally{i.f()}return n}function b(e,t){var r,n=[],i=Object(c.a)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=t(a[0],a[1],[0,0]);n.push(s),a.length>2&&s.push(a[2]),a.length>3&&s.push(a[3])}}catch(u){i.e(u)}finally{i.f()}return n}function g(e,t){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(i.a.mark((function e(t,r){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return n=Array.isArray(t)?t.map((function(e){var t;return null==(t=e.geometry)?void 0:t.spatialReference})):[t],e.next=5,Object(p.c)(n.map((function(e){return{source:e,dest:r}})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=v.bind(null,f.c),j=v.bind(null,f.f);function _(e,t,r){return e?(r||(r=t,t=e.spatialReference),Object(h.i)(t)&&Object(h.i)(r)&&!Object(h.c)(t,r)?Object(f.a)(t,r)?Object(h.m)(r)?O(e):j(e):Object(p.i)(d.a,[e],t,r,null)[0]:e):e}var I=new(function(){function e(){Object(a.a)(this,e),this._jobs=[],this._timer=null,this._process=this._process.bind(this)}return Object(s.a)(e,[{key:"push",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){var a,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!t||!t.length||!r||!n||Object(h.c)(r,n),a={geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:null},e.abrupt("return",(this._jobs.push(a),Object(l.c)((function(e){a.resolve=e,null===s._timer&&(s._timer=setTimeout(s._process,10))}))));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_process",value:function(){this._timer=null;var e=this._jobs.shift();if(e){var t=e.geometries,r=e.inSpatialReference,n=e.outSpatialReference,i=e.resolve;Object(f.a)(r,n)?Object(h.m)(n)?i(t.map(O)):i(t.map(j)):i(Object(p.i)(d.a,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}}]),e}());function w(e,t,r){return S.apply(this,arguments)}function S(){return(S=Object(u.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I.push(t,r,n));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},796:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(16);function i(e,t){return e?t?4:3:t?3:2}function a(e,t,r,a,c){if(!t||!t.lengths.length)return null;var o="upperLeft"===(null==c?void 0:c.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);var l,h=e.coords,f=[],p=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],d=t.lengths,m=t.coords,v=i(r,a),y=0,b=Object(n.a)(d);try{for(b.s();!(l=b.n()).done;){var g=l.value,x=s(p,m,y,g,r,a,o);x&&f.push(x),y+=g*v}}catch(_){b.e(_)}finally{b.f()}if(f.sort((function(e,t){var n=o*e[2]-o*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),f.length){var O=6*f[0][2];h[0]=f[0][0]/O,h[1]=f[0][1]/O,r&&(O=6*f[0][4],h[2]=0!==O?f[0][3]/O:0),(h[0]<p[0]||h[0]>p[1]||h[1]<p[2]||h[1]>p[3]||r&&(h[2]<p[4]||h[2]>p[5]))&&(h.length=0)}if(!h.length){var j=t.lengths[0]?u(m,0,d[0],r,a):null;if(!j)return null;h[0]=j[0],h[1]=j[1],r&&j.length>2&&(h[2]=j[2])}return e}function s(e,t,r,n,a,s){for(var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=i(a,s),o=r,l=r+c,h=0,f=0,p=0,d=0,m=0,v=0,y=n-1;v<y;v++,o+=c,l+=c){var b=t[o],g=t[o+1],x=t[o+2],O=t[l],j=t[l+1],_=t[l+2],I=b*j-O*g;d+=I,h+=(b+O)*I,f+=(g+j)*I,a&&(p+=(x+_)*(I=b*_-O*x),m+=I),b<e[0]&&(e[0]=b),b>e[1]&&(e[1]=b),g<e[2]&&(e[2]=g),g>e[3]&&(e[3]=g),a&&(x<e[4]&&(e[4]=x),x>e[5]&&(e[5]=x))}if(d*u>0&&(d*=-1),m*u>0&&(m*=-1),!d)return null;var w=[h,f,.5*d];return a&&(w[3]=p,w[4]=.5*m),w}function u(e,t,r,n,a){for(var s=i(n,a),u=t,f=t+s,p=0,d=0,m=0,v=0,y=0,b=r-1;y<b;y++,u+=s,f+=s){var g=e[u],x=e[u+1],O=e[u+2],j=e[f],_=e[f+1],I=e[f+2],w=n?o(g,x,O,j,_,I):c(g,x,j,_);if(w)if(p+=w,n){var S=h(g,x,O,j,_,I);d+=w*S[0],m+=w*S[1],v+=w*S[2]}else{var M=l(g,x,j,_);d+=w*M[0],m+=w*M[1]}}return p>0?n?[d/p,m/p,v/p]:[d/p,m/p]:r>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function c(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function o(e,t,r,n,i,a){var s=n-e,u=i-t,c=a-r;return Math.sqrt(s*s+u*u+c*c)}function l(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function h(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}},808:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2),i={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){var n=new a(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),s=e.hasM(t);return i&&(n.z=e.getPointZ(t)),s&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new s(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new u(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new c(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){var n=e.hasZ(t),i=e.hasM(t),a=new o(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){var s=e.getZExtent(t);a.zmin=s.vmin,a.zmax=s.vmax}if(i){var u=e.getMExtent(t);a.mmin=u.vmin,a.mmax=u.vmax}return a}},a=function e(t,r,i){Object(n.a)(this,e),this.x=t,this.y=r,this.spatialReference=i,this.z=void 0,this.m=void 0},s=function e(t,r,i,a){Object(n.a)(this,e),this.rings=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)},u=function e(t,r,i,a){Object(n.a)(this,e),this.paths=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)},c=function e(t,r,i,a){Object(n.a)(this,e),this.points=t,this.spatialReference=r,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),a&&(this.hasM=a)},o=function e(t,r,i,a,s){Object(n.a)(this,e),this.xmin=t,this.ymin=r,this.xmax=i,this.ymax=a,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}},809:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return c}));var n=r(44),i=r(11),a=r(13),s=r(18),u=r(202);function c(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?u.a:"esriGeometryPolyline"===e?u.c:u.b}}}function o(e,t){if(Object(a.a)("csp-restrictions"))return function(){return Object(i.a)(Object(n.a)({},t,null),e)};try{var r="this.".concat(t," = null;");for(var s in e)r+="this".concat(s.indexOf(".")?'["'.concat(s,'"]'):".".concat(s)," = ").concat(JSON.stringify(e[s]),";");var u=new Function(r);return function(){return new u}}catch(c){return function(){return Object(i.a)(Object(n.a)({},t,null),e)}}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:Object(s.a)(e)}}]}},810:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(914);function i(e,t){if(!(this instanceof i))return new i(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}function a(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function s(e,t){u(e,0,e.children.length,t,e)}function u(e,t,r,n,i){i||(i=m(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a,s=t;s<r;s++)a=e.children[s],c(i,e.leaf?n(a):a);return i}function c(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function o(e,t){return e.minX-t.minX}function l(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,t,r,i,a){for(var s,u=[t,r];u.length;)(r=u.pop())-(t=u.pop())<=i||(s=t+Math.ceil((r-t)/i/2)*i,Object(n.a)(e,s,t,r,a),u.push(t,s,s,r))}i.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],n=this.toBBox;if(!d(e,t))return r;for(var i,a,s,u,c=[];t;){for(i=0,a=t.children.length;i<a;i++)s=t.children[i],d(e,u=t.leaf?n(s):s)&&(t.leaf?r.push(s):p(e,u)?this._all(s,r):c.push(s));t=c.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!d(e,t))return!1;for(var n,i,a,s,u=[];t;){for(n=0,i=t.children.length;n<i;n++)if(a=t.children[n],d(e,s=t.leaf?r(a):a)){if(t.leaf||p(e,s))return!0;u.push(a)}t=u.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(e,t){if(!e)return this;for(var r,n,i,s,u=this.data,c=this.toBBox(e),o=[],l=[];u||o.length;){if(u||(u=o.pop(),n=o[o.length-1],r=l.pop(),s=!0),u.leaf&&-1!==(i=a(e,u.children,t)))return u.children.splice(i,1),o.push(u),this._condense(o),this;s||u.leaf||!p(u,c)?n?(r++,u=n.children[r],s=!1):u=null:(o.push(u),l.push(r),r=0,n=u,u=u.children[0])}return this},toBBox:function(e){return e},compareMinX:o,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,n){var i,a=r-t+1,u=this._maxEntries;if(a<=u)return s(i=m(e.slice(t,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,n-1))),(i=m([])).leaf=!1,i.height=n;var c,o,l,h,f=Math.ceil(a/u),p=f*Math.ceil(Math.sqrt(u));for(v(e,t,r,p,this.compareMinX),c=t;c<=r;c+=p)for(v(e,c,l=Math.min(c+p-1,r),f,this.compareMinY),o=c;o<=l;o+=f)h=Math.min(o+f-1,l),i.children.push(this._build(e,o,h,n-1));return s(i,this.toBBox),i},_chooseSubtree:function(e,t,r,n){for(var i,a,s,u,c,o,l,f,p,d;n.push(t),!t.leaf&&n.length-1!==r;){for(l=f=1/0,i=0,a=t.children.length;i<a;i++)c=h(s=t.children[i]),p=e,d=s,(o=(Math.max(d.maxX,p.maxX)-Math.min(d.minX,p.minX))*(Math.max(d.maxY,p.maxY)-Math.min(d.minY,p.minY))-c)<f?(f=o,l=c<l?c:l,u=s):o===f&&c<l&&(l=c,u=s);t=u||t.children[0]}return t},_insert:function(e,t,r){var n=this.toBBox,i=r?e:n(e),a=[],s=this._chooseSubtree(i,this.data,t,a);for(s.children.push(e),c(s,i);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(i,a,t)},_split:function(e,t){var r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n),u=m(r.children.splice(a,r.children.length-a));u.height=r.height,u.leaf=r.leaf,s(r,this.toBBox),s(u,this.toBBox),t?e[t-1].children.push(u):this._splitRoot(r,u)},_splitRoot:function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var n,i,a,s,c,o,l,f,p,d,m,v,y,b;for(o=l=1/0,n=t;n<=r-t;n++)p=i=u(e,0,n,this.toBBox),d=a=u(e,n,r,this.toBBox),void 0,void 0,void 0,void 0,m=Math.max(p.minX,d.minX),v=Math.max(p.minY,d.minY),y=Math.min(p.maxX,d.maxX),b=Math.min(p.maxY,d.maxY),s=Math.max(0,y-m)*Math.max(0,b-v),c=h(i)+h(a),s<o?(o=s,f=n,l=c<l?c:l):s===o&&c<l&&(l=c,f=n);return f},_chooseSplitAxis:function(e,t,r){var n=e.leaf?this.compareMinX:o,i=e.leaf?this.compareMinY:l;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)},_allDistMargin:function(e,t,r,n){e.children.sort(n);var i,a,s=this.toBBox,o=u(e,0,t,s),l=u(e,r-t,r,s),h=f(o)+f(l);for(i=t;i<r-t;i++)a=e.children[i],c(o,e.leaf?s(a):a),h+=f(o);for(i=r-t-1;i>=t;i--)a=e.children[i],c(l,e.leaf?s(a):a),h+=f(l);return h},_adjustParentBBoxes:function(e,t,r){for(var n=r;n>=0;n--)c(t[n],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():s(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},811:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2),i=r(3),a=r(403),s=function(){function e(t,r){Object(n.a)(this,e),this._storage=new a.b,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(i.a)(e,[{key:"put",value:function(e,t){this._storage.put(e,t,1,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.clearAll()}}]),e}()},856:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return m}));var n=r(31);r(182);var i=function(e,t,r){return[t,r]},a=function(e,t,r){return[t,r,e[2]]},s=function(e,t,r){return[t,r,e[2],e[3]]};function u(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null}function c(e,t){var r=e.scale,n=e.translate;return t*r[0]+n[0]}function o(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function l(e,t,r){var i=new Array(r.length);if(!r.length)return i;var a=Object(n.a)(e.scale,2),s=a[0],u=a[1],l=c(e,r[0][0]),h=o(e,r[0][1]);i[0]=t(r[0],l,h);for(var f=1;f<r.length;f++){var p=r[f];l+=p[0]*s,h-=p[1]*u,i[f]=t(p,l,h)}return i}function h(e,t,r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=l(e,t,r[i]);return n}function f(e,t,r,n,u){return t.points=function(e,t,r,n){return l(e,r?n?s:a:n?a:i,t)}(e,r.points,n,u),t}function p(e,t,r,n,i){return t.x=c(e,r.x),t.y=o(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m)),t}function d(e,t,r,n,u){return t.rings=function(e,t,r,n){return h(e,r?n?s:a:n?a:i,t)}(e,r.rings,n,u),t}function m(e,t,r,n,u){return t.paths=function(e,t,r,n){return h(e,r?n?s:a:n?a:i,t)}(e,r.paths,n,u),t}},886:function(e,t,r){"use strict";r.d(t,"a",(function(){return H}));var n=r(16),i=r(8),a=r.n(i),s=r(22),u=r(3),c=r(2),o=r(18),l=r(10),h=r(21),f=r(15),p=r(40),d=r(301),m=r(182),v=r(78),y=r(108),b=r(403),g=r(503),x=r(392),O=r(915),j=r(768),_=r(787),I=r(39),w=r(811),S=r(678),M=new(function(){function e(t,r){Object(c.a)(this,e),this._cache=new w.a(t),this._invalidCache=new w.a(r)}return Object(u.a)(e,[{key:"get",value:function(e,t){var r="".concat(t.uid,":").concat(e),n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var i=S.WhereClause.create(e,t);return this._cache.put(r,i),i}catch(a){return this._invalidCache.put(r,null),null}}}]),e}())(50,500),k="feature-store:unsupported-query",R=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function F(e,t,r){if(!t)return!0;var n=M.get(t,e);if(!n)throw new h.a(k,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new h.a(k,"having does not contain a valid aggregate function",{having:t});var i=n.fieldNames;if(A(e,i,"having contains missing fields"),!n.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new h.a(k,"expressions in having should also exist in outStatistics",{having:t});return!0}function N(e,t){return e?M.get(e,t):null}function A(e,t,r){var i,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=[],u=Object(n.a)(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;if("*"!==c&&!e.has(c))if(a){var o=T(c);try{var l=N(o,e);if(!l)throw new h.a(k,"invalid SQL expression",{where:o});if(!l.isStandardized)throw new h.a(k,"expression is not standard",{clause:l});A(e,l.fieldNames,"expression contains missing fields")}catch(p){var f=p&&p.details;if(f&&(f.clause||f.where))throw p;f&&f.missingFields?s.push.apply(s,Object(I.a)(f.missingFields)):s.push(c)}}else s.push(c)}}catch(d){u.e(d)}finally{u.f()}if(s.length)throw new h.a(k,r,{missingFields:s})}function T(e){return e.split(" as ")[0]}function Q(e,t){var r=t.get(e);return!!r&&!R.has(r.type)}var E=r(941),P=r(916),G=r(11),C=r(761),Y=r(856),B=function(){function e(t,r,i){Object(c.a)(this,e),this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=i,this.featureAdapter=r;var a=t.outFields;if(a&&-1===a.indexOf("*")){this.outFields=a;var s,u=0,o=Object(n.a)(a);try{for(o.s();!(s=o.n()).done;){var l=s.value,h=T(l),f=this.fieldsIndex.get(h),p=f?null:N(h,i),d=f?f.name:l.split(" as ")[1]||"FIELD_EXP_"+u++;this._fieldDataCache.set(l,{alias:d,clause:p})}}catch(m){o.e(m)}finally{o.f()}}}return Object(u.a)(e,[{key:"countDistinctValues",value:function(e){var t=this;return this.returnDistinctValues?(e.forEach((function(e){return t.getAttributes(e)})),this._returnDistinctMap.size):e.length}},{key:"getAttributes",value:function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}},{key:"getFieldValue",value:function(e,t,r){var n=r?r.name:t,i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n).clause:r||(i=N(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i.calculateValue(e,this.featureAdapter)}},{key:"validateItem",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:N(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}},{key:"validateItems",value:function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:N(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}},{key:"_processAttributesForOutFields",value:function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);var r,i={},a=Object(n.a)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,u=this._fieldDataCache.get(s),c=u.alias,o=u.clause;i[c]=o?o.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,c)}}catch(l){a.e(l)}finally{a.f()}return i}},{key:"_processAttributesForDistinctValues",value:function(e){if(Object(l.f)(e)||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t){var i,a=Object(n.a)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=this._fieldDataCache.get(s).alias;r.push(e[u])}}catch(f){a.e(f)}finally{a.f()}}else for(var c in e)r.push(e[c]);var o="".concat((t||["*"]).join(","),"=").concat(r.join(",")),h=this._returnDistinctMap.get(o)||0;return this._returnDistinctMap.set(o,++h),h>1?null:e}}]),e}();function q(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function V(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function X(e,t,r){return r?t-e:e-t}function D(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){var i=new Date(e).getTime(),a=new Date(t).getTime();if(!isNaN(i)&&!isNaN(a))return X(i,a,n)}if("number"==typeof e&&"number"==typeof t)return X(e,t,n);if("string"==typeof e&&"string"==typeof t){var s=e.toUpperCase(),u=t.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?V(s,u,n):V(q(s),q(u),n)}return n?1:-1}var z=function(){function e(t,r,n){Object(c.a)(this,e),this.items=t,this.queryGeometry=r,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}return Object(u.a)(e,[{key:"createQueryResponseForCount",value:function(e){var t=new B(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);var r=e.groupByFieldsForStatistics,i=e.having;if(!(null==r?void 0:r.length))return 1;var a,s=new Map,u=new Map,c=new Set,o=e.outStatistics,l=Object(n.a)(o);try{for(l.s();!(a=l.n()).done;){var h=a.value,f="exceedslimit"!==h.statisticType?h.onStatisticField:void 0;if(!u.has(f)){var p,d=[],m=Object(n.a)(r);try{for(m.s();!(p=m.n()).done;){var v=p.value,y=this._getAttributeValues(t,v,s);d.push(y)}}catch(I){m.e(I)}finally{m.f()}u.set(f,this._calculateUniqueValues(d))}var b=u.get(f);for(var g in b){var x=b[g],O=x.data,j=x.items,_=O.join(",");i&&!t.validateItems(j,i)||c.add(_)}}}catch(I){l.e(I)}finally{l.f()}return c.size}},{key:"createQueryResponse",value:function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(p.i)(e.outSR)&&!Object(p.c)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(E.d)(Object(G.a)({spatialReference:e.outSR},Object(_.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=Object(E.d)(Object(G.a)({spatialReference:e.outSR},this.queryGeometry))),t}},{key:"executeAttributesQuery",value:function(t){var r=N(t.where,this.fieldsIndex);if(!r)return Object(f.s)(this);if(r.isStandardized){var i,a=0,s=[],u=Object(n.a)(this.items);try{for(u.s();!(i=u.n()).done;){var c=i.value;r.testFeature(c,this.featureAdapter)&&(s[a++]=c)}}catch(l){u.e(l)}finally{u.f()}var o=new e(s,this.queryGeometry,this);return o.definitionExpression=t.where,Object(f.s)(o)}return Object(f.r)(new TypeError("Where clause is not standardized"))}},{key:"executeAggregateIdsQuery",value:function(t){if(!t.aggregateIds||!t.aggregateIds.length||Object(l.f)(this.aggregateAdapter))return Object(f.s)(this);var r,i=new Set,a=Object(n.a)(t.aggregateIds);try{for(a.s();!(r=a.n()).done;){var s=r.value;this.aggregateAdapter.getFeatureObjectIds(s).forEach((function(e){return i.add(e)}))}}catch(c){a.e(c)}finally{a.f()}var u=this.featureAdapter.getObjectId;return Object(f.s)(new e(this.items.filter((function(e){return i.has(u(e))})),this.queryGeometry,this))}},{key:"executeObjectIdsQuery",value:function(t){if(!t.objectIds||!t.objectIds.length)return Object(f.s)(this);var r=new Set(t.objectIds),n=this.featureAdapter.getObjectId;return Object(f.s)(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))}},{key:"executeTimeQuery",value:function(t){var r=Object(P.b)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!Object(l.g)(r))return Object(f.s)(this);var n=this.items.filter(r);return Object(f.s)(new e(n,this.queryGeometry,this))}},{key:"filterLatest",value:function(){var t,r=this.timeInfo,i=r.trackIdField,a=r.startTimeField,s=r.endTimeField||a,u=new Map,c=this.featureAdapter.getAttribute,o=Object(n.a)(this.items);try{for(o.s();!(t=o.n()).done;){var l=t.value,h=c(l,i),p=c(l,s),d=u.get(h);(!d||p>c(d,s))&&u.set(h,l)}}catch(v){o.e(v)}finally{o.f()}var m=Array.from(u.values());return Object(f.s)(new e(m,this.queryGeometry,this))}},{key:"project",value:function(){var t=Object(s.a)(a.a.mark((function t(r){var n,i,s=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r&&!Object(p.c)(this.spatialReference,r)){t.next=2;break}return t.abrupt("return",this);case 2:return n=this.featureAdapter,t.next=5,Object(_.c)(this.items.map((function(e){return Object(E.f)(s.geometryType,s.hasZ,s.hasM,n.getGeometry(e))})),this.spatialReference,r);case 5:return i=t.sent.map((function(e,t){return n.cloneWithGeometry(s.items[t],Object(C.d)(e,s.hasZ,s.hasM))})),t.abrupt("return",new e(i,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:r,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter}));case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_sortFeatures",value:function(e,t,r){var i=this;if(e.length>1&&t&&t.length){var a,s=Object(n.a)(t.reverse());try{var u=function(){var t=a.value.split(" "),n=t[0],s=i.fieldsIndex.get(n),u=t[1]&&"desc"===t[1].toLowerCase();e.sort((function(e,t){return D(r(e,n,s),r(t,n,s),s,u)}))};for(s.s();!(a=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}}}},{key:"_createFeatureQueryResponse",value:function(e){var t=this,r=this.items,n=this.geometryType,i=this.hasM,a=this.hasZ,s=this.objectIdField,u=this.spatialReference,c=e.outFields,o=e.outSR,l=e.quantizationParameters,h=e.resultRecordCount,f=e.resultOffset,p=e.returnZ,d=e.returnM,m=null!=h&&r.length>(f||0)+h,v=c&&(c.indexOf("*")>-1?Object(I.a)(this.fieldsIndex.fields):c.map((function(e){return t.fieldsIndex.get(e)})));return{exceededTransferLimit:m,features:this._createFeatures(e,r),fields:v,geometryType:n,hasM:i&&d,hasZ:a&&p,objectIdFieldName:s,spatialReference:Object(E.d)(o||u),transform:l&&Object(Y.a)(l)||null}}},{key:"_createFeatures",value:function(e,t){var r=new B(e,this.featureAdapter,this.fieldsIndex),i=this.hasM,a=this.hasZ,s=e.orderByFields,u=e.quantizationParameters,c=e.returnGeometry,o=e.returnCentroid,l=e.maxAllowableOffset,h=e.resultOffset,f=e.resultRecordCount,p=e.returnZ,d=void 0!==p&&p,m=e.returnM,v=a&&d,y=i&&(void 0!==m&&m),b=[],g=0,x=Object(I.a)(t);if(this._sortFeatures(x,s,(function(e,t,n){return r.getFieldValue(e,t,n)})),c||o){var O=Object(Y.a)(u);if(c&&!o){var j,_=Object(n.a)(x);try{for(_.s();!(j=_.n()).done;){var w=j.value;b[g++]={attributes:r.getAttributes(w),geometry:Object(E.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(w),l,O,v,y)}}}catch(q){_.e(q)}finally{_.f()}}else if(!c&&o){var S,M=Object(n.a)(x);try{for(M.s();!(S=M.n()).done;){var k=S.value;b[g++]={attributes:r.getAttributes(k),centroid:Object(E.i)(this,this.featureAdapter.getCentroid(k,this),O)}}}catch(q){M.e(q)}finally{M.f()}}else{var R,F=Object(n.a)(x);try{for(F.s();!(R=F.n()).done;){var N=R.value;b[g++]={attributes:r.getAttributes(N),centroid:Object(E.i)(this,this.featureAdapter.getCentroid(N,this),O),geometry:Object(E.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(N),l,O,v,y)}}}catch(q){F.e(q)}finally{F.f()}}}else{var A,T=Object(n.a)(x);try{for(T.s();!(A=T.n()).done;){var Q=A.value,P=r.getAttributes(Q);P&&(b[g++]={attributes:P})}}catch(q){T.e(q)}finally{T.f()}}var G=h||0;if(null!=f){var C=G+f;b=b.slice(G,Math.min(b.length,C))}return b}},{key:"_createExceedsLimitQueryResponse",value:function(e){var t,r=!1,i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=Object(n.a)(e.outStatistics);try{for(u.s();!(t=u.n()).done;){var c=t.value;if("exceedslimit"===c.statisticType){i=null!=c.maxPointCount?c.maxPointCount:Number.POSITIVE_INFINITY,a=null!=c.maxRecordCount?c.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=c.maxVertexCount?c.maxVertexCount:Number.POSITIVE_INFINITY;break}}}catch(h){u.e(h)}finally{u.f()}if("esriGeometryPoint"===this.geometryType)r=this.items.length>i;else if(this.items.length>a)r=!0;else{var o=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;r=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/o>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(r)}}]}}},{key:"_createStatisticsQueryResponse",value:function(e){var t,r=this,i={attributes:{}},a=[],s=new Map,u=new Map,c=new Map,o=new Map,l=new B(e,this.featureAdapter,this.fieldsIndex),h=e.outStatistics,f=e.groupByFieldsForStatistics,p=e.having,d=e.orderByFields,m=f&&f.length,v=!!m,y=v&&f[0],b=v&&!this.fieldsIndex.get(y),g=Object(n.a)(h);try{for(g.s();!(t=g.n()).done;){var x=t.value,O=x.outStatisticFieldName,j=x.statisticType,_=x,I="exceedslimit"!==j?x.onStatisticField:void 0,w="percentile_disc"===j||"percentile_cont"===j,S=v&&1===m&&(I===y||b)&&"count"===j;if(v){if(!c.has(I)){var M,k=[],R=Object(n.a)(f);try{for(R.s();!(M=R.n()).done;){var F=M.value,N=this._getAttributeValues(l,F,s);k.push(N)}}catch(G){R.e(G)}finally{R.f()}c.set(I,this._calculateUniqueValues(k))}var A=c.get(I),T=function(e){var t=A[e],n=t.count,i=t.data,a=t.items,u=t.itemPositions,c=i.join(",");if(!p||l.validateItems(a,p)){var h=o.get(c)||{attributes:{}},d=null;if(S)d=n;else{var m=r._getAttributeValues(l,I,s),v=u.map((function(e){return m[e]}));d=w&&"statisticParameters"in _?r._getPercentileValue(_,v):r._getStatisticValue(_,v)}h.attributes[O]=d,f.forEach((function(e,t){return h.attributes[r.fieldsIndex.get(e)?e:"EXPR_".concat(t+1)]=i[t]})),o.set(c,h)}};for(var Q in A)T(Q)}else{var E=this._getAttributeValues(l,I,s);i.attributes[O]=w&&"statisticParameters"in _?this._getPercentileValue(_,E):this._getStatisticValue(_,E,u)}a.push({name:O,alias:O,type:"esriFieldTypeDouble"})}}catch(G){g.e(G)}finally{g.f()}var P=v?Array.from(o.values()):[i];return this._sortFeatures(P,d,(function(e,t){return e.attributes[t]})),{fields:a,features:P}}},{key:"_getStatisticValue",value:function(e,t,r){var n=e.onStatisticField,i=e.statisticType,a=r&&r.has(n)?r.get(n):this._calculateStatistics(t);return r&&r.set(n,a),a["var"===i?"variance":i]}},{key:"_getPercentileValue",value:function(e,t){var r=e.onStatisticField,n=e.statisticParameters,i=e.statisticType,a=n.value,s="desc"===n.orderBy,u=this.fieldsIndex.get(r),c=Object(I.a)(t).filter((function(e){return null!=e})).sort((function(e,t){return D(e,t,u,s)}));return this._calculatePercentile(c,a,"percentile_disc"===i)}},{key:"_getAttributeValues",value:function(e,t,r){if(r.has(t))return r.get(t);var n=this.fieldsIndex.get(t),i=this.items.map((function(r){return e.getFieldValue(r,t,n)}));return r.set(t,i),i}},{key:"_calculateStatistics",value:function(e){var t,r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=null,s=null,u=null,c=null,o=[],l=0,h=Object(n.a)(e);try{for(h.s();!(t=h.n()).done;){var f=t.value;"string"==typeof f?l++:null==f||isNaN(f)||(a+=f,r=Math.min(r,f),i=Math.max(i,f),o.push(f),l++)}}catch(y){h.e(y)}finally{h.f()}if(l){s=a/l;var p,d=0,m=Object(n.a)(o);try{for(m.s();!(p=m.n()).done;){var v=p.value;d+=Math.pow(v-s,2)}}catch(y){m.e(y)}finally{m.f()}c=l>1?d/(l-1):0,u=Math.sqrt(c)}else r=null,i=null;return{avg:s,count:l,max:i,min:r,stddev:u,sum:a,variance:c}}},{key:"_calculateUniqueValues",value:function(e){for(var t={},r=this.items,i=r.length,a=0;a<i;a++){var s,u=r[a],c=[],o=Object(n.a)(e);try{for(o.s();!(s=o.n()).done;){var l=s.value;c.push(l[a])}}catch(f){o.e(f)}finally{o.f()}var h=c.join(",");null==t[h]?t[h]={count:1,data:c,items:[u],itemPositions:[a]}:(t[h].count++,t[h].items.push(u),t[h].itemPositions.push(a))}return t}},{key:"_calculatePercentile",value:function(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];var n=(e.length-1)*t,i=Math.floor(n),a=i+1,s=n%1,u=e[i],c=e[a];return a>=e.length||r||"string"==typeof u||"string"==typeof c?u:u*(1-s)+c*s}},{key:"size",get:function(){return this.items.length}}]),e}(),Z=new Set,L=new b.b(2e6),J=0,U=Object(j.b)(),W=Object(j.b)(),H=function(){function e(t){var r=this;Object(c.a)(this,e),this.capabilities={query:O.a},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(function(){return r.clearCache()})),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new b.a(J+++"$$",L)),this.fieldsIndex=new x.a(t.fields),t.scheduler&&t.task&&(this._frameQueue=new g.a,this._frameTask=t.scheduler.registerTask(t.task,(function(e){return r._update(e)}),(function(){return r._frameQueue.length>0})))}return Object(u.a)(e,[{key:"destroy",value:function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}},{key:"clearCache",value:function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}},{key:"executeQuery",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,r,n,i,s=this,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,i=Object(o.a)(t),e.prev=3,e.next=6,this._schedule((function(){return Object(E.b)(i,s.definitionExpression,s.spatialReference)}),r);case 6:return i=e.sent,e.next=9,this._reschedule((function(){return s._checkQuerySupport(i)}),r);case 9:return i=e.sent,e.next=12,this._reschedule((function(){return s._executeGeometryQuery(i,r)}),r);case 12:return n=e.sent,e.next=15,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 15:return n=e.sent,e.next=18,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 18:return n=e.sent,e.next=21,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 21:return n=e.sent,e.next=24,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 24:n=e.sent,e.next=32;break;case 27:if(e.prev=27,e.t0=e.catch(3),e.t0===E.a){e.next=31;break}throw e.t0;case 31:n=new z([],null,this);case 32:return e.abrupt("return",n.createQueryResponse(i));case 33:case"end":return e.stop()}}),e,this,[[3,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForCount",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,r,n,i,s=this,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,(i=Object(o.a)(t)).returnGeometry=!1,i.returnCentroid=!1,i.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(E.b)(i,s.definitionExpression,s.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return s._checkQuerySupport(i)}),r);case 10:return i=e.sent,e.next=13,this._reschedule((function(){return s._executeGeometryQuery(i,r)}),r);case 13:return n=e.sent,e.next=16,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 25:n=e.sent,e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(4),e.t0===E.a){e.next=32;break}throw e.t0;case 32:return e.abrupt("return",0);case 33:return e.abrupt("return",n.createQueryResponseForCount(i));case 34:case"end":return e.stop()}}),e,this,[[4,28]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForExtent",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,r,n,i,s,u,c,l,h,f,p,d=this,m=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},r=m.length>1?m[1]:void 0,i=Object(o.a)(t),s=i.outSR,e.prev=4,e.next=7,this._schedule((function(){return Object(E.b)(i,d.definitionExpression,d.spatialReference)}),r);case 7:return i=e.sent,e.next=10,this._reschedule((function(){return d._checkQuerySupport(i)}),r);case 10:return(i=e.sent).returnGeometry=!0,i.returnCentroid=!1,i.outSR=null,e.next=16,this._reschedule((function(){return d._executeGeometryQuery(i,r)}),r);case 16:return n=e.sent,e.next=19,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 19:return n=e.sent,e.next=22,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 22:return n=e.sent,e.next=25,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 25:return n=e.sent,e.next=28,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 28:if(n=e.sent,u=n.size){e.next=32;break}return e.abrupt("return",{count:u,extent:null});case 32:return Object(j.j)(W,j.a),this.featureStore.forEachBounds(n.items,(function(e){return Object(j.e)(W,e)}),U),c={xmin:W[0],ymin:W[1],xmax:W[3],ymax:W[4],spatialReference:Object(E.d)(this.spatialReference)},this.hasZ&&isFinite(W[2])&&isFinite(W[5])&&(c.zmin=W[2],c.zmax=W[5]),(l=Object(_.b)(c,n.spatialReference,s)).spatialReference=Object(E.d)(s||this.spatialReference),l.xmax-l.xmin==0&&(h=Object(v.b)(l.spatialReference),l.xmin-=h,l.xmax+=h),l.ymax-l.ymin==0&&(f=Object(v.b)(l.spatialReference),l.ymin-=f,l.ymax+=f),this.hasZ&&null!=l.zmin&&null!=l.zmax&&l.zmax-l.zmin==0&&(p=Object(v.b)(l.spatialReference),l.zmin-=p,l.zmax+=p),e.abrupt("return",{count:u,extent:l});case 42:if(e.prev=42,e.t0=e.catch(4),e.t0!==E.a){e.next=46;break}return e.abrupt("return",{count:0,extent:null});case 46:throw e.t0;case 47:case"end":return e.stop()}}),e,this,[[4,42]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIds",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,r,n=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1?n[1]:void 0,e.abrupt("return",this.executeQueryForIdSet(t,r).then((function(e){return Array.from(e)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForIdSet",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,r,i,s,u,c,l=this,h=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.length>0&&void 0!==h[0]?h[0]:{},r=h.length>1?h[1]:void 0,(s=Object(o.a)(t)).returnGeometry=!1,s.returnCentroid=!1,s.outSR=null,e.prev=4,e.next=7,this._schedule((function(){return Object(E.b)(s,l.definitionExpression,l.spatialReference)}),r);case 7:return s=e.sent,e.next=10,this._reschedule((function(){return l._checkQuerySupport(s)}),r);case 10:return s=e.sent,e.next=13,this._reschedule((function(){return l._executeGeometryQuery(s,r)}),r);case 13:return i=e.sent,e.next=16,this._reschedule((function(){return i.executeAggregateIdsQuery(s)}),r);case 16:return i=e.sent,e.next=19,this._reschedule((function(){return i.executeObjectIdsQuery(s)}),r);case 19:return i=e.sent,e.next=22,this._reschedule((function(){return i.executeTimeQuery(s)}),r);case 22:return i=e.sent,e.next=25,this._reschedule((function(){return i.executeAttributesQuery(s)}),r);case 25:return i=e.sent,u=i.items,c=new Set,e.next=29,this._reschedule((function(){var e,t=Object(n.a)(u);try{for(t.s();!(e=t.n()).done;){var r=e.value;c.add(i.featureAdapter.getObjectId(r))}}catch(a){t.e(a)}finally{t.f()}}),r);case 29:return e.abrupt("return",c);case 32:if(e.prev=32,e.t0=e.catch(4),e.t0!==E.a){e.next=36;break}return e.abrupt("return",new Set);case 36:throw e.t0;case 37:case"end":return e.stop()}}),e,this,[[4,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"executeQueryForLatestObservations",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,r,n,i,s=this,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},r=u.length>1?u[1]:void 0,this.timeInfo&&this.timeInfo.trackIdField){e.next=4;break}throw new h.a("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});case 4:return i=Object(o.a)(t),e.prev=5,e.next=8,this._schedule((function(){return Object(E.b)(i,s.definitionExpression,s.spatialReference)}),r);case 8:return i=e.sent,e.next=11,this._reschedule((function(){return s._checkQuerySupport(i)}),r);case 11:return i=e.sent,e.next=14,this._reschedule((function(){return s._executeGeometryQuery(i,r)}),r);case 14:return n=e.sent,e.next=17,this._reschedule((function(){return n.executeAggregateIdsQuery(i)}),r);case 17:return n=e.sent,e.next=20,this._reschedule((function(){return n.executeObjectIdsQuery(i)}),r);case 20:return n=e.sent,e.next=23,this._reschedule((function(){return n.executeTimeQuery(i)}),r);case 23:return n=e.sent,e.next=26,this._reschedule((function(){return n.executeAttributesQuery(i)}),r);case 26:return n=e.sent,e.next=29,this._reschedule((function(){return n.filterLatest()}),r);case 29:n=e.sent,e.next=37;break;case 32:if(e.prev=32,e.t0=e.catch(5),e.t0===E.a){e.next=36;break}throw e.t0;case 36:n=new z([],null,this);case 37:return e.abrupt("return",n.createQueryResponse(i));case 38:case"end":return e.stop()}}),e,this,[[5,32]])})));return function(){return e.apply(this,arguments)}}()},{key:"_schedule",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.push(t,r):t());case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_reschedule",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._frameQueue?this._frameQueue.unshift(t,r):t());case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_update",value:function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}},{key:"_getAll",value:function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new z(e,null,this)}return this._allItems}},{key:"_executeGeometryQuery",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var i,u,c,o,h,f,d,m,v,y,b,g,x,O,j,_,I,w,S,M=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.geometry,u=t.outSR,c=t.spatialRel,o=Object(p.i)(u)&&!Object(p.c)(this.spatialReference,u),!(h=this._geometryQueryCache?o?JSON.stringify({geometry:i,spatialRelationship:c,outSpatialReference:u}):JSON.stringify({geometry:i,spatialRelationship:c}):null)){e.next=5;break}if(f=this._geometryQueryCache.get(h),Object(l.h)(f)){e.next=5;break}return e.abrupt("return",f);case 5:if(d=function(){var e=Object(s.a)(a.a.mark((function e(r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o||!t.returnGeometry&&!t.returnCentroid){e.next=5;break}return e.next=3,r.project(u);case 3:return n=e.sent,e.abrupt("return",(h&&M._geometryQueryCache.put(h,n,n.size||1),n));case 5:return e.abrupt("return",(h&&M._geometryQueryCache.put(h,r,r.size||1),r));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i){e.next=8;break}return e.abrupt("return",d(this._getAll()));case 8:if(m=this.featureAdapter,"esriSpatialRelDisjoint"!==c){e.next=23;break}if((v=this._searchFeatures(this._getQueryBBoxes(i))).length){e.next=13;break}return e.abrupt("return",d(this._getAll()));case 13:g=new Set,x=Object(n.a)(v);try{for(x.s();!(O=x.n()).done;)j=O.value,g.add(m.getObjectId(j))}catch(k){x.e(k)}finally{x.f()}return e.next=18,this._reschedule((function(){var e=0;y=new Array(g.size),M.featureStore.forEach((function(t){return y[e++]=t})),b=g}),r);case 18:return e.t0=d,e.next=21,this._reschedule(Object(s.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.g)(c,i,M.geometryType,M.hasZ,M.hasM);case 2:return t=e.sent,e.t0=z,e.next=6,M._runSpatialFilter(y,(function(e){return!b.has(m.getObjectId(e))||t(m.getGeometry(e))}),r);case 6:return e.t1=e.sent,e.t2=i,e.t3=M,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 10:case"end":return e.stop()}}),e)}))),r);case 21:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 23:if((_=this._searchFeatures(this._getQueryBBoxes(i))).length){e.next=27;break}return I=new z([],i,this),e.abrupt("return",(h&&this._geometryQueryCache.put(h,I,I.size||1),I));case 27:if(!this._canExecuteSoloPass(i,t)){e.next=29;break}return e.abrupt("return",d(new z(_,i,this)));case 29:return e.next=31,Object(E.g)(c,i,this.geometryType,this.hasZ,this.hasM);case 31:return w=e.sent,e.next=34,this._runSpatialFilter(_,(function(e){return w(m.getGeometry(e))}),r);case 34:return S=e.sent,e.abrupt("return",d(new z(S,i,this)));case 36:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_runSpatialFilter",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n){var i,u,c,o=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:if(this._budget){e.next=4;break}return e.abrupt("return",t.filter((function(e){return r(e)})));case 4:return i=0,u=new Array,c=function(){var e=Object(s.a)(a.a.mark((function e(){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<t.length)){e.next=10;break}if(s=t[i],r(s)&&u.push(s),e.t0=o._budget.done,!e.t0){e.next=7;break}return e.next=7,o._reschedule((function(){return c()}),n);case 7:++i;case 8:e.next=0;break;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",this._reschedule((function(){return c()}),n).then((function(){return u})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_canExecuteSoloPass",value:function(e,t){var r=this.geometryType,n=t.spatialRel;return Object(E.c)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}},{key:"_getQueryBBoxes",value:function(e){if(Object(E.c)(e)){if(Object(m.d)(e))return[Object(y.j)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(m.g)(e))return e.rings.map((function(e){return Object(y.j)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[Object(d.a)(Object(y.e)(),e)]}},{key:"_searchFeatures",value:function(e){var t,r=Object(n.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.featureStore.forEachInBounds(i,(function(e){Z.add(e)}))}}catch(u){r.e(u)}finally{r.f()}var a=new Array(Z.size),s=0;return Z.forEach((function(e){return a[s++]=e})),Z.clear(),a}},{key:"_checkQuerySupport",value:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)){e.next=2;break}throw new h.a("feature-store:unsupported-query","Unsupported query options",{query:t});case 2:return e.abrupt("return",Object(f.b)([this._checkAttributesQuerySupport(t),this._checkStatisticsQuerySupport(t),Object(E.e)(t,this.geometryType,this.spatialReference),Object(_.a)(this.spatialReference,t.outSR)]).then((function(){return t})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_checkAttributesQuerySupport",value:function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues,i=e.outStatistics,a=i?i.map((function(e){return e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()})):[];if(r&&r.length>0){var s=r.map((function(e){var t=e.toLowerCase();return t.indexOf(" asc")>-1?t.split(" asc")[0]:t.indexOf(" desc")>-1?t.split(" desc")[0]:e})).filter((function(e){return-1===a.indexOf(e)}));A(this.fieldsIndex,s,"orderByFields contains missing fields")}if(t&&t.length>0)A(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new h.a("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;var r=M.get(t,e);if(!r)throw new h.a(k,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new h.a(k,"where clause is not standard",{where:t});A(e,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}},{key:"_checkStatisticsQuerySupport",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,i,s,u,c,o,l,f,p,d,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outStatistics,i=t.groupByFieldsForStatistics,s=t.having,u=i&&i.length,c=r&&r.length,!s){e.next=5;break}if(u&&c){e.next=4;break}throw new h.a("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});case 4:F(this.fieldsIndex,s,r);case 5:if(!c){e.next=34;break}if(function(e){return e.every((function(e){return"exceedslimit"!==e.statisticType}))}(r)){e.next=8;break}return e.abrupt("return");case 8:o=r.map((function(e){return e.onStatisticField})),A(this.fieldsIndex,o,"onStatisticFields contains missing fields"),u&&A(this.fieldsIndex,i,"groupByFieldsForStatistics contains missing fields"),l=Object(n.a)(r),e.prev=11,l.s();case 13:if((f=l.n()).done){e.next=26;break}if(p=f.value,d=p.onStatisticField,"percentile_disc"!==(m=p.statisticType)&&"percentile_cont"!==m||!("statisticParameters"in p)){e.next=22;break}if(p.statisticParameters){e.next=20;break}throw new h.a("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:p,query:t});case 20:e.next=24;break;case 22:if("count"===m||!d||!Q(d,this.fieldsIndex)){e.next=24;break}throw new h.a("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:p,query:t});case 24:e.next=13;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(11),l.e(e.t0);case 31:return e.prev=31,l.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[11,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()},{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}},{key:"fullExtent",get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(E.d)(this.spatialReference)}:null}},{key:"timeExtent",get:function(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(P.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}}]),e}()},914:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(226),i=Object(n.b)((function(e){var t;void 0!==(t=function(){function e(r,n,i,a,s){for(;a>i;){if(a-i>600){var u=a-i+1,c=n-i+1,o=Math.log(u),l=.5*Math.exp(2*o/3),h=.5*Math.sqrt(o*l*(u-l)/u)*(c-u/2<0?-1:1);e(r,n,Math.max(i,Math.floor(n-c*l/u+h)),Math.min(a,Math.floor(n+(u-c)*l/u+h)),s)}var f=r[n],p=i,d=a;for(t(r,i,n),s(r[a],f)>0&&t(r,i,a);p<d;){for(t(r,p,d),p++,d--;s(r[p],f)<0;)p++;for(;s(r[d],f)>0;)d--}0===s(r[i],f)?t(r,i,d):t(r,++d,a),d<=n&&(i=d+1),n<=d&&(a=d-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,i,a,s){e(t,n,i||0,a||t.length-1,s||r)}}())&&(e.exports=t)}))},915:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},916:function(e,t,r){"use strict";function n(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),u=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==u||isNaN(u)||(s=Math.max(s,u))}));else{var u=n||i;t.forEach((function(e){var t=r.getAttribute(e,u);null==t||isNaN(t)||(a=Math.min(a,t),s=Math.max(s,t))}))}return{start:a,end:s}}function i(e,t,r){if(!t||!e)return null;var n=e.startTimeField,i=e.endTimeField;if(!n&&!i)return null;var a=t.start,s=t.end;return null===a&&null===s?null:void 0===a&&void 0===s?function(){return!1}:n&&i?function(e,t,r,n,i){return null!=n&&null!=i?function(a){var s=e.getAttribute(a,t),u=e.getAttribute(a,r);return(null==s||s<=i)&&(null==u||u>=n)}:null!=n?function(t){var i=e.getAttribute(t,r);return null==i||i>=n}:null!=i?function(r){var n=e.getAttribute(r,t);return null==n||n<=i}:void 0}(r,n,i,a,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){var a=e.getAttribute(i,t);return a>=r&&a<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(r,n||i,a,s)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}))},941:function(e,t,r){"use strict";r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return A})),r.d(t,"c",(function(){return J})),r.d(t,"d",(function(){return P})),r.d(t,"e",(function(){return Z})),r.d(t,"f",(function(){return N})),r.d(t,"g",(function(){return z})),r.d(t,"h",(function(){return Q})),r.d(t,"i",(function(){return F}));var n=r(8),i=r.n(n),a=r(16),s=r(22),u=r(10),c=r(34),o=r(21),l=r(15),h=r(40),f=r(120),p=r(304),d=r(312),m=r(182),v=r(78),y=r(764),b=r(765),g=r(761),x=(r(796),r(787));function O(e,t){return e?t?4:3:t?3:2}function j(e,t,r,n,i){if(!e)return!1;var s,u=O(t,r),c=e.coords,o=e.lengths,l=!1,h=0,f=Object(a.a)(o);try{for(f.s();!(s=f.n()).done;){var p=s.value;l=_(l,c,u,h,p,n,i),h+=p*u}}catch(d){f.e(d)}finally{f.f()}return l}function _(e,t,r,n,i,a,s){for(var u=e,c=n,o=n,l=n+i*r;o<l;o+=r){(c=o+r)===l&&(c=n);var h=t[o],f=t[o+1],p=t[c],d=t[c+1];(f<s&&d>=s||d<s&&f>=s)&&h+(s-f)/(d-f)*(p-h)<a&&(u=!u)}return u}var I=new c.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),w=Object.freeze({}),S=new b.a,M=new b.a,k=new b.a,R={esriGeometryPoint:g.j,esriGeometryPolyline:g.l,esriGeometryPolygon:g.k,esriGeometryMultipoint:g.i};function F(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM,a=e.hasZ&&n,s=e.hasM&&i;if(r){var u=Object(g.r)(k,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,i);return Object(g.j)(u,a,s)}return Object(g.j)(t,a,s)}function N(e,t,r,n,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:r,c=t&&s,o=r&&u,l=n?"coords"in n?n:n.geometry:null;if(!l)return null;if(i){var h=Object(g.n)(M,l,t,r,e,i,s,u);return a&&(h=Object(g.r)(k,h,c,o,e,a)),R[e](h,c,o)}if(a){var f=Object(g.r)(k,l,t,r,e,a,s,u);return R[e](f,c,o)}return Object(g.u)(S,l,t,r,s,u),R[e](S,c,o)}function A(e,t,r){return T.apply(this,arguments)}function T(){return(T=Object(s.a)(i.a.mark((function e(t,r,n){var a,s,u,c,o,l,h,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.outFields,s=t.orderByFields,u=t.groupByFieldsForStatistics,c=t.outStatistics,a)for(o=0;o<a.length;o++)a[o]=a[o].trim();if(s)for(l=0;l<s.length;l++)s[l]=s[l].trim();if(u)for(h=0;h<u.length;h++)u[h]=u[h].trim();if(c)for(f=0;f<c.length;f++)c[f].onStatisticField&&(c[f].onStatisticField=c[f].onStatisticField.trim());return e.abrupt("return",(t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),Q(t,r,n)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e,t,r){return E.apply(this,arguments)}function E(){return(E=Object(s.a)(i.a.mark((function e(t,r,n){var a,c,o,l,f,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(a=t.where,t.where=a=a&&a.trim(),(!a||/^1 *= *1$/.test(a)||r&&r===a)&&(t.where=null),t.geometry){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,function(){var e=Object(s.a)(i.a.mark((function e(t){var r,n,a,s,u,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.geometry,n=t.distance,a=t.units,null!=n&&!("vertexAttributes"in r)){e.next=3;break}return e.abrupt("return",r);case 3:if(s=r.spatialReference,u=a?I.fromJSON(a):Object(v.d)(s),!s||!Object(h.f)(s)&&!Object(h.m)(s)){e.next=9;break}e.t0=r,e.next=12;break;case 9:return e.next=11,Object(x.a)(s,h.a).then((function(){return Object(x.b)(r,h.a)}));case 11:e.t0=e.sent;case 12:return c=e.t0,e.next=15,D();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t1)(c.spatialReference,c,n,u));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(t);case 7:return c=e.sent,t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel&&(o=t.geometry.spatialReference,(c=Object(d.a)(c)).spatialReference=o),t.geometry=c,e.next=12,Object(x.a)(c.spatialReference,n);case 12:return e.next=14,Object(y.a)(Object(m.a)(c));case 14:if(l=e.sent[0],!Object(u.f)(l)){e.next=17;break}throw w;case 17:return f=l.toJSON(),e.next=20,Object(x.b)(f,f.spatialReference,n);case 20:if(p=e.sent){e.next=23;break}throw w;case 23:return e.abrupt("return",(p.spatialReference=n,t.geometry=p,t));case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return e&&G in e?JSON.parse(JSON.stringify(e,C)):e}var G="_geVersion",C=function(e,t){return e!==G?t:void 0},Y={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},B={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},q={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},V={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function X(){return r.e(24).then(r.bind(null,960))}function D(){return X().then((function(e){return e.geodesicBuffer}))}function z(e,t,r,n,i){if(Object(m.g)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var a=Object(g.e)(new b.a,t,!1,!1);return Object(l.s)((function(e){return function(e,t,r,n){return j(e,t,r,n.coords[0],n.coords[1])}(a,!1,!1,e)}))}if(Object(m.g)(t)&&"esriGeometryMultipoint"===r){var s=Object(g.e)(new b.a,t,!1,!1);if("esriSpatialRelContains"===e)return Object(l.s)((function(e){return function(e,t,r,n,i,a){var s=O(i,a),u=n.coords,c=n.lengths;if(!c)return!1;for(var o=0,l=0;o<c.length;o++,l+=s)if(!j(e,t,r,u[l],u[l+1]))return!1;return!0}(s,!1,!1,e,n,i)}))}if(Object(m.d)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Object(l.s)((function(e){return Object(f.e)(t,N(r,n,i,e))}));if(Object(m.d)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Object(l.s)((function(e){return Object(f.d)(t,N(r,n,i,e))}));if(Object(m.d)(t)&&"esriSpatialRelIntersects"===e){var u=Object(p.a)(r);return Object(l.s)((function(e){return u(t,N(r,n,i,e))}))}return X().then((function(a){var s=a[Y[e]].bind(null,t.spatialReference,t);return function(e){return s(N(r,n,i,e))}}))}function Z(e,t,r){return L.apply(this,arguments)}function L(){return(L=Object(s.a)(i.a.mark((function e(t,r,n){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.spatialRel,!(s=t.geometry)){e.next=11;break}if(!0===B[a]){e.next=4;break}throw new o.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:t});case 4:if(!Object(h.i)(s.spatialReference)||!Object(h.i)(n)){e.next=11;break}if(function(e){return!0===q[Object(m.c)(e)]}(s)){e.next=7;break}throw new o.a("feature-store:unsupported-query","Unsupported query geometry type",{query:t});case 7:if(function(e){return!0===V[e]}(r)){e.next=9;break}throw new o.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:t});case 9:if(!t.outSR){e.next=11;break}return e.abrupt("return",Object(x.a)(t.geometry&&t.geometry.spatialReference,t.outSR));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){if(Object(m.d)(e))return!0;if(Object(m.g)(e)){var t,r=Object(a.a)(e.rings);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}}catch(i){r.e(i)}finally{r.f()}return!0}return!1}}}]);
//# sourceMappingURL=7.c92b38fe.chunk.js.map