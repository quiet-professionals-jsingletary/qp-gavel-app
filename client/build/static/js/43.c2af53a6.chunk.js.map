{"version":3,"sources":["../node_modules/@arcgis/core/layers/graphics/sources/FeatureLayerSource.js","../node_modules/@arcgis/core/tasks/geometry/cut.js","../node_modules/@arcgis/core/tasks/geometry/simplify.js","../node_modules/@arcgis/core/geometry/support/normalizeUtils.js","../node_modules/@arcgis/core/tasks/Task.js","../node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js"],"names":["q","Set","I","arguments","type","e","t","s","signal","this","addResolvingPromise","_fetchService","d","load","r","attributes","layer","objectIdField","a","parsedUrl","path","_getLayerRequestOptions","o","_getFormDataForAttachment","query","p","body","_createFeatureEditResult","data","addAttachmentResult","_createAttachmentErrorResult","attachmentId","i","updateAttachmentResult","addFeatures","map","_serializeFeature","updateFeatures","_getFeatureIds","deleteFeatures","g","spatialReference","u","deleteAttachments","addAttachments","_serializeAttachment","push","updateAttachments","n","length","adds","updates","deletes","l","method","JSON","stringify","join","gdbVersion","rollbackOnFailure","rollbackOnFailureEnabled","useGlobalIds","globalIdUsed","attachments","_createEditsResult","attachmentIds","deleteAttachmentResults","then","returnUpdates","layerId","url","id","extent","fullExtent","timeExtent","y","fromJSON","f","start","end","get","objectIds","c","parentObjectId","attachmentInfos","b","queryTask","executeAttachmentQuery","execute","customParameters","executeJSON","executeForIds","executeForCount","executeForExtent","executeRelationshipQuery","executeRelationshipQueryForCount","sourceJSON","returnAdvancedSymbols","_patchServiceJSON","has","geometryType","drawingInfo","renderer","defaultSymbol","R","geometry","toJSON","feature","attachment","globalId","name","contentType","uploadId","parentGlobalId","globalIdField","h","FileReader","readAsDataURL","onload","result","onerror","mediaType","File","_getIdsFromFeatureIdentifier","_getIdsFromFeatures","objectId","addFeatureResults","addResults","updateFeatureResults","updateResults","deleteFeatureResults","deleteResults","addAttachmentResults","updateAttachmentResults","success","error","code","description","details","messages","message","httpStatus","messageCode","FormData","elements","set","append","dynamicDataSource","source","responseType","capabilities","supportsFormatPBF","fieldsIndex","F","format","sourceSpatialReference","m","prototype","constructOnly","readOnly","dependsOn","_","sr","target","geometries","cutter","cutIndexes","wkid","getLogger","102100","maxX","minX","plus180Line","paths","WebMercator","minus180Line","4326","WGS84","x","w","rings","Math","ceil","L","sqrt","floor","M","Array","isArray","clone","offset","P","geometryServiceUrl","A","S","v","j","isWebMercator","U","X","W","k","points","_normalize","xmin","intersects","xmax","z","G","addPath","some","Number","toFixed","getPoint","setPoint","addRing","shift","D","requestOptions","_encode","_parseUrl","String","symbol","indexOf","Function"],"mappings":"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","file":"static/js/43.c2af53a6.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/has.js\";import{fixJson as r}from\"../../../core/lang.js\";import{setDeepValue as a}from\"../../../core/object.js\";import{isSome as s,isNone as o}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as u}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../core/Error.js\";import{dataComponents as l}from\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{resolve as d,all as c,create as h}from\"../../../core/promiseUtils.js\";import y from\"../../../geometry/Extent.js\";import p from\"../../../request.js\";import m from\"../../../core/Loadable.js\";import f from\"../../../TimeExtent.js\";import{unapplyEditsZUnitScaling as g}from\"../../../tasks/operations/zscale.js\";import{processAttachmentQueryResult as b}from\"../../../tasks/operations/queryAttachments.js\";import F from\"../../../tasks/QueryTask.js\";import{createDrawingInfo as R}from\"./support/clientSideDefaults.js\";const q=new Set([\"Feature Layer\",\"Table\"]);let I=class extends m{constructor(){super(...arguments),this.type=\"feature-layer\"}load(e){const t=s(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),d(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:e}},parsedUrl:r,dynamicDataSource:a,gdbVersion:s,spatialReference:o,fieldsIndex:i}=this.layer,u=t(\"featurelayer-pbf\")&&e?\"pbf\":\"json\";return new F({url:r.path,format:u,fieldsIndex:i,dynamicDataSource:a,gdbVersion:s,sourceSpatialReference:o})}async addAttachment(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/addAttachment\",s=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,s.query);try{const e=await p(a,{body:o});return this._createFeatureEditResult(e.data.addAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}async updateAttachment(e,t,r){await this.load();const a=e.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+\"/\"+a+\"/updateAttachment\",o=this._getLayerRequestOptions({query:{attachmentId:t}}),i=this._getFormDataForAttachment(r,o.query);try{const e=await p(s,{body:i});return this._createFeatureEditResult(e.data.updateAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(a,e)}}async applyEdits(e,t){await this.load();const r=e.addFeatures.map(this._serializeFeature,this),a=e.updateFeatures.map(this._serializeFeature,this),s=this._getFeatureIds(e.deleteFeatures);g(r,a,this.layer.spatialReference);const o=[],i=[],u=[...e.deleteAttachments];for(const t of e.addAttachments)o.push(await this._serializeAttachment(t));for(const t of e.updateAttachments)i.push(await this._serializeAttachment(t));const n=o.length||i.length||u.length?{adds:o,updates:i,deletes:u}:null,l=this._getLayerRequestOptions({method:\"post\",query:{adds:r.length?JSON.stringify(r):null,updates:a.length?JSON.stringify(a):null,deletes:s.length?s.join(\",\"):null,gdbVersion:null==t?void 0:t.gdbVersion,rollbackOnFailure:null==t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:null==t?void 0:t.globalIdUsed,attachments:n&&JSON.stringify(n)}}),d=await p(this.layer.parsedUrl.path+\"/applyEdits\",l);return this._createEditsResult(d)}async deleteAttachments(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/deleteAttachments\";try{return(await p(a,this._getLayerRequestOptions({query:{attachmentIds:t.join(\",\")},method:\"post\"}))).data.deleteAttachmentResults.map(this._createFeatureEditResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}fetchRecomputedExtents(e={}){const t=e.signal;return this.load({signal:t}).then((async()=>{const t=this._getLayerRequestOptions({...e,query:{returnUpdates:!0}}),{layerId:r,url:a}=this.layer,{data:s}=await p(`${a}/${r}`,t),{id:o,extent:i,fullExtent:u,timeExtent:n}=s,l=i||u;return{id:o,fullExtent:l&&y.fromJSON(l),timeExtent:n&&f.fromJSON({start:n[0],end:n[1]})}}))}async queryAttachments(e,t={}){const{parsedUrl:r}=this.layer,a=r.path;await this.load();const s=this._getLayerRequestOptions(t);if(!this.layer.get(\"capabilities.operations.supportsQueryAttachments\")){const{objectIds:t}=e,r=[];for(const e of t){const t=a+\"/\"+e+\"/attachments\";r.push(p(t,s))}return c(r).then((e=>t.map(((t,r)=>({parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}))))).then((e=>b(e,a)))}return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){return await this.load(),this.queryTask.execute(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async _fetchService(e){let r=this.layer.sourceJSON;if(!r){const{data:a}=await p(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:t(\"featurelayer-advanced-symbols\")?{returnAdvancedSymbols:!0}:{},signal:e}));r=a}this.sourceJSON=this._patchServiceJSON(r);const a=r.type;if(!q.has(a))throw new n(\"feature-layer-source:unsupported-type\",`Source type \"${a}\" is not supported`)}_patchServiceJSON(e){var t;if(\"Table\"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){const t=R(e.geometryType).renderer;a(\"drawingInfo.renderer\",t,e)}return e}_serializeFeature(e){const{geometry:t,attributes:r}=e;return o(t)?{attributes:r}:\"mesh\"===t.type||\"extent\"===t.type?null:{geometry:t.toJSON(),attributes:r}}async _serializeAttachment(e){const{feature:t,attachment:r}=e,{globalId:a,name:s,contentType:o,data:i,uploadId:u}=r,n={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(n.parentGlobalId=\"attributes\"in t?t.attributes&&t.attributes[this.layer.globalIdField]:t.globalId),u)n.uploadId=u;else if(i){const e=await async function(e){if(\"string\"==typeof e){return l(e)||{data:e}}return h(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(l(a.result)),a.onerror=e=>r(e)}))}(i);n.contentType=e.mediaType,n.data=e.data,i instanceof File&&(n.name=i.name)}return s&&(n.name=s),o&&(n.contentType=o),n}_getFeatureIds(e){const t=e[0];return t?\"objectId\"in t?this._getIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}_getIdsFromFeatures(e){const t=this.layer.objectIdField;return e.map((e=>e.attributes&&e.attributes[t]))}_getIdsFromFeatureIdentifier(e){return e.map((e=>e.objectId))}_createEditsResult(e){const t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new n(\"feature-layer-source:edit-failure\",t.description,{code:t.code}):null}}_createAttachmentErrorResult(e,t){const r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new n(\"feature-layer-source:attachment-failure\",r,{code:a})}}_getFormDataForAttachment(e,t){const r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(const e in t){const a=t[e];null!=a&&(r.set?r.set(e,a):r.append(e,a))}return r}_getLayerRequestOptions(e={}){const{parsedUrl:t,gdbVersion:a,dynamicDataSource:s}=this.layer;return{...e,query:r({gdbVersion:a,layer:s?JSON.stringify({source:s}):void 0,...t.query,f:\"json\",...this.layer.customParameters,...null==e?void 0:e.query}),responseType:\"json\"}}};e([i()],I.prototype,\"type\",void 0),e([i({constructOnly:!0})],I.prototype,\"layer\",void 0),e([i({readOnly:!0,dependsOn:[\"layer.parsedUrl\",\"layer.gdbVersion\",\"layer.dynamicDataSource\",\"layer.fieldsIndex\"]})],I.prototype,\"queryTask\",null),I=e([u(\"esri.layers.graphics.sources.FeatureLayerSource\")],I);var _=I;export default _;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{urlToObject as e}from\"../../core/urlUtils.js\";import{getJsonType as t,fromJSON as r}from\"../../geometry/support/jsonUtils.js\";import\"../../geometry.js\";import s from\"../../request.js\";async function o(o,i,n,m){const p=\"string\"==typeof o?e(o):o,a=i[0].spatialReference,u={...m,query:{...p.query,f:\"json\",sr:JSON.stringify(a),target:JSON.stringify({geometryType:t(i[0]),geometries:i}),cutter:JSON.stringify(n)}},c=await s(p.path+\"/cut\",u),{cutIndexes:f,geometries:g=[]}=c.data;return{cutIndexes:f,geometries:g.map((e=>{const t=r(e);return t.spatialReference=a,t}))}}export{o as cut};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{urlToObject as r}from\"../../core/urlUtils.js\";import{getJsonType as t,getGeometryType as e}from\"../../geometry/support/jsonUtils.js\";import o from\"../../request.js\";async function i(i,n,f){const m=\"string\"==typeof i?r(i):i,p=n[0].spatialReference,a=t(n[0]),u={...f,query:{...m.query,f:\"json\",sr:p.wkid?p.wkid:JSON.stringify(p),geometries:JSON.stringify(s(n))}};return function(r,t,o){const i=e(t);return r.map((r=>{const t=i.fromJSON(r);return t.spatialReference=o,t}))}((await o(m.path+\"/simplify\",u)).data,a,p)}function s(r){return{geometryType:t(r[0]),geometries:r.map((r=>r.toJSON()))}}export{i as simplify};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"../../config.js\";import{isNone as t,isSome as n}from\"../../core/maybe.js\";import s from\"../../core/Logger.js\";import o from\"../../core/Error.js\";import{resolve as r}from\"../../core/promiseUtils.js\";import{getInfo as i}from\"./spatialReferenceUtils.js\";import f from\"../SpatialReference.js\";import{geographicToWebMercator as l,webMercatorToGeographic as c}from\"./webMercatorUtils.js\";import p from\"../Polygon.js\";import a from\"../Polyline.js\";import{cut as u}from\"../../tasks/geometry/cut.js\";import{simplify as h}from\"../../tasks/geometry/simplify.js\";const m=s.getLogger(\"esri.geometry.support.normalizeUtils\"),g={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:f.WebMercator}),minus180Line:new a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:f.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new a({paths:[[[180,-180],[180,180]]],spatialReference:f.WGS84}),minus180Line:new a({paths:[[[-180,-180],[-180,180]]],spatialReference:f.WGS84})}};function x(e){return\"polygon\"===e.type}function y(e){return\"polyline\"===e[0].type}function w(e){return x(e)?e.rings:e.paths}function R(e,t){return Math.ceil((e-t)/(2*t))}function d(e,t){const n=w(e);for(const e of n)for(const n of e)n[0]+=t;return e}function j(e){const t=[];let n=0,s=0;for(let o=0;o<e.length;o++){const r=e[o];let i=null;for(let e=0;e<r.length;e++)i=r[e],t.push(i),0===e?(n=i[0],s=n):(n=Math.min(n,i[0]),s=Math.max(s,i[0]));i&&t.push([(n+s)/2,0])}return t}function M(e,t){if(!(e instanceof a||e instanceof p)){const e=\"straightLineDensify: the input geometry is neither polyline nor polygon\";throw m.error(e),new o(e)}const n=w(e),s=[];for(const e of n){const n=[];s.push(n),n.push([e[0][0],e[0][1]]);for(let s=0;s<e.length-1;s++){const o=e[s][0],r=e[s][1],i=e[s+1][0],f=e[s+1][1],l=Math.sqrt((i-o)*(i-o)+(f-r)*(f-r)),c=(f-r)/l,p=(i-o)/l,a=l/t;if(a>1){for(let e=1;e<=a-1;e++){const s=e*t,i=p*s+o,f=c*s+r;n.push([i,f])}const e=(l+Math.floor(a-1)*t)/2,s=p*e+o,i=c*e+r;n.push([s,i])}n.push([i,f])}}return x(e)?new p({rings:s,spatialReference:e.spatialReference}):new a({paths:s,spatialReference:e.spatialReference})}function L(e,t,n){if(t){const t=M(e,1e6);e=c(t,!0)}return n&&(e=d(e,n)),e}function b(e,t,n){if(Array.isArray(e)){const s=e[0];if(s>t){const n=R(s,t);e[0]=s+n*(-2*t)}else if(s<n){const t=R(s,n);e[0]=s+t*(-2*n)}}else{const s=e.x;if(s>t){const n=R(s,t);e=e.clone().offset(n*(-2*t),0)}else if(s<n){const t=R(s,n);e=e.clone().offset(t*(-2*n),0)}}return e}async function P(s,o,f){if(!Array.isArray(s))return P([s],o);const c=o?o.url:e.geometryServiceUrl;let m,x,j,M,X,U,W,k,A=0;const S=[],v=[];for(const e of s)if(t(e))v.push(e);else if(m||(m=e.spatialReference,x=i(m),j=m.isWebMercator,U=j?102100:4326,M=g[U].maxX,X=g[U].minX,W=g[U].plus180Line,k=g[U].minus180Line),x)if(\"mesh\"===e.type)v.push(e);else if(\"point\"===e.type)v.push(b(e.clone(),M,X));else if(\"multipoint\"===e.type){const t=e.clone();t.points=t.points.map((e=>b(e,M,X))),v.push(t)}else if(\"extent\"===e.type){const t=e.clone()._normalize(!1,!1,x);v.push(t.rings?new p(t):t)}else if(e.extent){const t=e.extent,n=R(t.xmin,X)*(2*M);let s=0===n?e.clone():d(e.clone(),n);t.offset(n,0),t.intersects(W)&&t.xmax!==M?(A=t.xmax>A?t.xmax:A,s=L(s,j),S.push(s),v.push(\"cut\")):t.intersects(k)&&t.xmin!==X?(A=t.xmax*(2*M)>A?t.xmax*(2*M):A,s=L(s,j,360),S.push(s),v.push(\"cut\")):v.push(s)}else v.push(e.clone());else v.push(e);let z=R(A,M),G=-90;const I=z,q=new a;for(;z>0;){const e=360*z-180;q.addPath([[e,G],[e,-1*G]]),G*=-1,z--}if(S.length>0&&I>0){const e=function(e,t){let n=-1;for(let s=0;s<t.cutIndexes.length;s++){const o=t.cutIndexes[s],r=t.geometries[s],i=w(r);for(let e=0;e<i.length;e++){const t=i[e];t.some((n=>{if(n[0]<180)return!0;{let n=0;for(let e=0;e<t.length;e++){const s=t[e][0];n=s>n?s:n}n=Number(n.toFixed(9));const s=-360*R(n,180);for(let n=0;n<t.length;n++){const t=r.getPoint(e,n);r.setPoint(e,n,t.clone().offset(s,0))}return!0}}))}if(o===n){if(\"polygon\"===e[0].type)for(const t of w(r))e[o]=e[o].addRing(t);else if(y(e))for(const t of w(r))e[o]=e[o].addPath(t)}else n=o,e[o]=r}return e}(S,await u(c,S,q,f)),t=[],o=[];for(let r=0;r<v.length;r++){const i=v[r];if(\"cut\"!==i)o.push(i);else{const i=e.shift(),f=s[r];n(f)&&\"polygon\"===f.type&&f.rings&&f.rings.length>1&&i.rings.length>=f.rings.length?(t.push(i),o.push(\"simplify\")):o.push(j?l(i):i)}}if(!t.length)return o;const r=await h(c,t,f),i=[];for(let e=0;e<o.length;e++){const t=o[e];\"simplify\"!==t?i.push(t):i.push(j?l(r.shift()):r.shift())}return i}const D=[];for(let e=0;e<v.length;e++){const t=v[e];if(\"cut\"!==t)D.push(t);else{const e=S.shift();D.push(!0===j?l(e):e)}}return r(D)}function X(e){if(!e)return null;const t=e.extent;if(!t)return null;const n=e.spatialReference&&i(e.spatialReference);if(!n)return t;const[s,o]=n.valid,r=2*o,{width:f}=t;let l,{xmin:c,xmax:p}=t;if([c,p]=[p,c],\"extent\"===e.type||0===f||f<=o||f>r||c<s||p>o)return t;switch(e.type){case\"polygon\":if(!(e.rings.length>1))return t;l=j(e.rings);break;case\"polyline\":if(!(e.paths.length>1))return t;l=j(e.paths);break;case\"multipoint\":l=e.points}const a=t.clone();for(let e=0;e<l.length;e++){let t=l[e][0];t<0?(t+=o,p=Math.max(t,p)):(t-=o,c=Math.min(t,c))}return a.xmin=c,a.xmax=p,a.width<f?(a.xmin-=o,a.xmax-=o,a):t}function U(e,t){const n=i(t);if(n){const[t,s]=n.valid,o=s-t;if(e<t)for(;e<t;)e+=o;if(e>s)for(;e>s;)e-=o}return e}export{X as getDenormalizedExtent,P as normalizeCentralMeridian,U as normalizeMapX,M as straightLineDensify};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as e}from\"../core/accessorSupport/decorators/subclass.js\";import{urlToObject as s}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import t from\"../core/Accessor.js\";let p=class extends t{constructor(...r){super(...r),this.requestOptions=null,this.url=null}normalizeCtorArgs(r,o){return\"string\"!=typeof r?r:{url:r,...o}}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(r){return r?s(r):null}_encode(r,o,e){const s={};for(const t in r){if(\"declaredClass\"===t)continue;const p=r[t];if(null!=p&&\"function\"!=typeof p)if(Array.isArray(p)){s[t]=[];for(let r=0;r<p.length;r++)s[t][r]=this._encode(p[r])}else if(\"object\"==typeof p)if(p.toJSON){const r=p.toJSON(e&&e[t]);s[t]=o?r:JSON.stringify(r)}else s[t]=o?p:JSON.stringify(p);else s[t]=p}return s}};r([o({readOnly:!0,dependsOn:[\"url\"]})],p.prototype,\"parsedUrl\",null),r([o()],p.prototype,\"requestOptions\",void 0),r([o({type:String})],p.prototype,\"url\",void 0),p=r([e(\"esri.tasks.Task\")],p);var i=p;export default i;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as r}from\"../../../../core/lang.js\";import{defaultPointSymbolJSON as e,defaultPolylineSymbolJSON as n,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function i(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?e:\"esriGeometryPolyline\"===t?n:o}}}function s(r,e){if(t(\"csp-restrictions\"))return()=>({[e]:null,...r});try{let t=`this.${e} = null;`;for(const e in r){t+=`this${e.indexOf(\".\")?`[\"${e}\"]`:`.${e}`} = ${JSON.stringify(r[e])};`}const n=new Function(t);return()=>new n}catch(t){return()=>({[e]:null,...r})}}function u(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:r(t)}}]}export{s as createDefaultAttributesFunction,u as createDefaultTemplate,i as createDrawingInfo};\n"],"sourceRoot":""}