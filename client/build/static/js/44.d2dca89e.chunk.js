(this["webpackJsonpqp-ampd-app"]=this["webpackJsonpqp-ampd-app"]||[]).push([[44],{764:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var a=r(8),n=r.n(a),u=(r(31),r(22)),s=r(16),c=r(68),i=r(10),o=r(12),l=r(21),p=r(15),f=r(40),d=r(36),h=r(65),y=r(122),b=r(121),v=r(11),O=r(9),m=r(182),j=(r(86),r(58));function g(e,t,r,a){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(n.a.mark((function e(t,r,a,u){var s,c,i,o,l,p,f,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="string"==typeof t?Object(O.I)(t):t,c=r[0].spatialReference,i=Object(v.a)(Object(v.a)({},u),{},{query:Object(v.a)(Object(v.a)({},s.query),{},{f:"json",sr:JSON.stringify(c),target:JSON.stringify({geometryType:Object(m.c)(r[0]),geometries:r}),cutter:JSON.stringify(a)})}),e.next=5,Object(j.default)(s.path+"/cut",i);case 5:return o=e.sent,l=o.data,p=l.cutIndexes,f=l.geometries,d=void 0===f?[]:f,e.abrupt("return",{cutIndexes:p,geometries:d.map((function(e){var t=Object(m.a)(e);return t.spatialReference=c,t}))});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t,r){return R.apply(this,arguments)}function R(){return(R=Object(u.a)(n.a.mark((function e(t,r,a){var u,s,c,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u="string"==typeof t?Object(O.I)(t):t,s=r[0].spatialReference,c=Object(m.c)(r[0]),i=Object(v.a)(Object(v.a)({},a),{},{query:Object(v.a)(Object(v.a)({},u.query),{},{f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify(w(r))})}),e.t0=function(e,t,r){var a=Object(m.b)(t);return e.map((function(e){var t=a.fromJSON(e);return t.spatialReference=r,t}))},e.next=4,Object(j.default)(u.path+"/simplify",i);case 4:return e.t1=e.sent.data,e.t2=c,e.t3=s,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return{geometryType:Object(m.c)(e[0]),geometries:e.map((function(e){return e.toJSON()}))}}var F=o.a.getLogger("esri.geometry.support.normalizeUtils"),q={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new b.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:d.a.WebMercator}),minus180Line:new b.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:d.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new b.a({paths:[[[180,-180],[180,180]]],spatialReference:d.a.WGS84}),minus180Line:new b.a({paths:[[[-180,-180],[-180,180]]],spatialReference:d.a.WGS84})}};function I(e){return"polygon"===e.type}function _(e){return"polyline"===e[0].type}function S(e){return I(e)?e.rings:e.paths}function A(e,t){return Math.ceil((e-t)/(2*t))}function J(e,t){var r,a=S(e),n=Object(s.a)(a);try{for(n.s();!(r=n.n()).done;){var u,c=r.value,i=Object(s.a)(c);try{for(i.s();!(u=i.n()).done;){u.value[0]+=t}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}return e}function N(e,t,r){if(t){var a=function(e,t){if(!(e instanceof b.a||e instanceof y.a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw F.error(r),new l.a(r)}var a,n=S(e),u=[],c=Object(s.a)(n);try{for(c.s();!(a=c.n()).done;){var i=a.value,o=[];u.push(o),o.push([i[0][0],i[0][1]]);for(var p=0;p<i.length-1;p++){var f=i[p][0],d=i[p][1],h=i[p+1][0],v=i[p+1][1],O=Math.sqrt((h-f)*(h-f)+(v-d)*(v-d)),m=(v-d)/O,j=(h-f)/O,g=O/t;if(g>1){for(var x=1;x<=g-1;x++){var k=x*t,R=j*k+f,w=m*k+d;o.push([R,w])}var q=(O+Math.floor(g-1)*t)/2,_=j*q+f,A=m*q+d;o.push([_,A])}o.push([h,v])}}}catch(J){c.e(J)}finally{c.f()}return I(e)?new y.a({rings:u,spatialReference:e.spatialReference}):new b.a({paths:u,spatialReference:e.spatialReference})}(e,1e6);e=Object(h.e)(a,!0)}return r&&(e=J(e,r)),e}function E(e,t,r){if(Array.isArray(e)){var a=e[0];if(a>t){var n=A(a,t);e[0]=a+n*(-2*t)}else if(a<r){var u=A(a,r);e[0]=a+u*(-2*r)}}else{var s=e.x;if(s>t){var c=A(s,t);e=e.clone().offset(c*(-2*t),0)}else if(s<r){var i=A(s,r);e=e.clone().offset(i*(-2*r),0)}}return e}function T(e,t,r){return L.apply(this,arguments)}function L(){return(L=Object(u.a)(n.a.mark((function e(t,r,a){var u,o,l,d,v,O,m,j,x,R,w,F,I,L,U,P,D,z,G,C,M,V,X,W,Q,B,H,K,Y,Z,$,ee,te,re,ae,ne,ue,se,ce,ie;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)){e.next=2;break}return e.abrupt("return",T([t],r));case 2:u=r?r.url:c.a.geometryServiceUrl,R=0,w=[],F=[],I=Object(s.a)(t);try{for(I.s();!(L=I.n()).done;)U=L.value,Object(i.f)(U)?F.push(U):(o||(o=U.spatialReference,l=Object(f.d)(o),d=o.isWebMercator,v=q[m=d?102100:4326].maxX,O=q[m].minX,j=q[m].plus180Line,x=q[m].minus180Line),l?"mesh"===U.type?F.push(U):"point"===U.type?F.push(E(U.clone(),v,O)):"multipoint"===U.type?((P=U.clone()).points=P.points.map((function(e){return E(e,v,O)})),F.push(P)):"extent"===U.type?(D=U.clone()._normalize(!1,!1,l),F.push(D.rings?new y.a(D):D)):U.extent?(z=U.extent,G=A(z.xmin,O)*(2*v),C=0===G?U.clone():J(U.clone(),G),z.offset(G,0),z.intersects(j)&&z.xmax!==v?(R=z.xmax>R?z.xmax:R,C=N(C,d),w.push(C),F.push("cut")):z.intersects(x)&&z.xmin!==O?(R=z.xmax*(2*v)>R?z.xmax*(2*v):R,C=N(C,d,360),w.push(C),F.push("cut")):F.push(C)):F.push(U.clone()):F.push(U))}catch(n){I.e(n)}finally{I.f()}for(M=A(R,v),V=-90,X=M,W=new b.a;M>0;)Q=360*M-180,W.addPath([[Q,V],[Q,-1*V]]),V*=-1,M--;if(!(w.length>0&&X>0)){e.next=28;break}return e.t0=function(e,t){for(var r=-1,a=function(a){for(var u=t.cutIndexes[a],c=t.geometries[a],i=S(c),o=function(e){var t=i[e];t.some((function(r){if(r[0]<180)return!0;for(var a=0,n=0;n<t.length;n++){var u=t[n][0];a=u>a?u:a}for(var s=-360*A(a=Number(a.toFixed(9)),180),i=0;i<t.length;i++){var o=c.getPoint(e,i);c.setPoint(e,i,o.clone().offset(s,0))}return!0}))},l=0;l<i.length;l++)o(l);if(u===r){if("polygon"===e[0].type){var p,f=Object(s.a)(S(c));try{for(f.s();!(p=f.n()).done;){var d=p.value;e[u]=e[u].addRing(d)}}catch(n){f.e(n)}finally{f.f()}}else if(_(e)){var h,y=Object(s.a)(S(c));try{for(y.s();!(h=y.n()).done;){var b=h.value;e[u]=e[u].addPath(b)}}catch(n){y.e(n)}finally{y.f()}}}else r=u,e[u]=c},u=0;u<t.cutIndexes.length;u++)a(u);return e},e.t1=w,e.next=15,g(u,w,W,a);case 15:for(e.t2=e.sent,B=(0,e.t0)(e.t1,e.t2),H=[],K=[],Y=0;Y<F.length;Y++)"cut"!==(Z=F[Y])?K.push(Z):($=B.shift(),ee=t[Y],Object(i.g)(ee)&&"polygon"===ee.type&&ee.rings&&ee.rings.length>1&&$.rings.length>=ee.rings.length?(H.push($),K.push("simplify")):K.push(d?Object(h.b)($):$));if(H.length){e.next=22;break}return e.abrupt("return",K);case 22:return e.next=24,k(u,H,a);case 24:for(te=e.sent,re=[],ae=0;ae<K.length;ae++)"simplify"!==(ne=K[ae])?re.push(ne):re.push(d?Object(h.b)(te.shift()):te.shift());return e.abrupt("return",re);case 28:for(ue=[],se=0;se<F.length;se++)"cut"!==(ce=F[se])?ue.push(ce):(ie=w.shift(),ue.push(!0===d?Object(h.b)(ie):ie));return e.abrupt("return",Object(p.s)(ue));case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},766:function(e,t,r){"use strict";var a=r(11),n=r(2),u=r(3),s=r(4),c=r(5),i=r(0),o=(r(13),r(12),r(14),r(1)),l=r(6),p=r(9),f=(r(19),r(20),function(e){Object(s.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(n.a)(this,r);for(var a=arguments.length,u=new Array(a),s=0;s<a;s++)u[s]=arguments[s];return(e=t.call.apply(t,[this].concat(u))).requestOptions=null,e.url=null,e}return Object(u.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"!=typeof e?e:Object(a.a)({url:e},t)}},{key:"_parseUrl",value:function(e){return e?Object(p.I)(e):null}},{key:"_encode",value:function(e,t,r){var a={};for(var n in e)if("declaredClass"!==n){var u=e[n];if(null!=u&&"function"!=typeof u)if(Array.isArray(u)){a[n]=[];for(var s=0;s<u.length;s++)a[n][s]=this._encode(u[s])}else if("object"==typeof u)if(u.toJSON){var c=u.toJSON(r&&r[n]);a[n]=t?c:JSON.stringify(c)}else a[n]=t?u:JSON.stringify(u);else a[n]=u}return a}},{key:"parsedUrl",get:function(){return this._parseUrl(this.url)}}]),r}(r(43).a));Object(i.a)([Object(o.b)({readOnly:!0,dependsOn:["url"]})],f.prototype,"parsedUrl",null),Object(i.a)([Object(o.b)()],f.prototype,"requestOptions",void 0),Object(i.a)([Object(o.b)({type:String})],f.prototype,"url",void 0);var d=f=Object(i.a)([Object(l.a)("esri.tasks.Task")],f);t.a=d},809:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return i}));var a=r(44),n=r(11),u=r(13),s=r(18),c=r(202);function i(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?c.a:"esriGeometryPolyline"===e?c.c:c.b}}}function o(e,t){if(Object(u.a)("csp-restrictions"))return function(){return Object(n.a)(Object(a.a)({},t,null),e)};try{var r="this.".concat(t," = null;");for(var s in e)r+="this".concat(s.indexOf(".")?'["'.concat(s,'"]'):".".concat(s)," = ").concat(JSON.stringify(e[s]),";");var c=new Function(r);return function(){return new c}}catch(i){return function(){return Object(n.a)(Object(a.a)({},t,null),e)}}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:Object(s.a)(e)}}]}},994:function(e,t,r){"use strict";r.r(t);var a=r(11),n=r(16),u=r(39),s=r(8),c=r.n(s),i=r(22),o=r(2),l=r(3),p=r(4),f=r(5),d=r(0),h=r(13),y=r(18),b=r(72),v=r(10),O=(r(12),r(14),r(1)),m=r(6),j=r(21),g=r(9),x=(r(19),r(20),r(15)),k=r(57),R=r(58),w=r(101),F=r(296),q=r(759),I=r(818),_=r(803),S=r(809),A=new Set(["Feature Layer","Table"]),J=function(e){Object(p.a)(r,e);var t=Object(f.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).type="feature-layer",e}return Object(l.a)(r,[{key:"load",value:function(e){var t=Object(v.g)(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Object(x.s)(this)}},{key:"addAttachment",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){var a,n,u,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return a=t.attributes[this.layer.objectIdField],n=this.layer.parsedUrl.path+"/"+a+"/addAttachment",u=this._getLayerRequestOptions(),s=this._getFormDataForAttachment(r,u.query),e.prev=3,e.next=6,Object(R.default)(n,{body:s});case 6:return i=e.sent,e.abrupt("return",this._createFeatureEditResult(i.data.addAttachmentResult));case 10:throw e.prev=10,e.t0=e.catch(3),this._createAttachmentErrorResult(a,e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateAttachment",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r,a){var n,u,s,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return n=t.attributes[this.layer.objectIdField],u=this.layer.parsedUrl.path+"/"+n+"/updateAttachment",s=this._getLayerRequestOptions({query:{attachmentId:r}}),i=this._getFormDataForAttachment(a,s.query),e.prev=3,e.next=6,Object(R.default)(u,{body:i});case 6:return o=e.sent,e.abrupt("return",this._createFeatureEditResult(o.data.updateAttachmentResult));case 10:throw e.prev=10,e.t0=e.catch(3),this._createAttachmentErrorResult(n,e.t0);case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"applyEdits",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){var a,s,i,o,l,p,f,d,h,y,b,v,O,m,j;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:a=t.addFeatures.map(this._serializeFeature,this),s=t.updateFeatures.map(this._serializeFeature,this),i=this._getFeatureIds(t.deleteFeatures),Object(q.b)(a,s,this.layer.spatialReference),o=[],l=[],p=Object(u.a)(t.deleteAttachments),f=Object(n.a)(t.addAttachments),e.prev=6,f.s();case 8:if((d=f.n()).done){e.next=17;break}return h=d.value,e.t0=o,e.next=13,this._serializeAttachment(h);case 13:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(6),f.e(e.t2);case 22:return e.prev=22,f.f(),e.finish(22);case 25:y=Object(n.a)(t.updateAttachments),e.prev=26,y.s();case 28:if((b=y.n()).done){e.next=37;break}return v=b.value,e.t3=l,e.next=33,this._serializeAttachment(v);case 33:e.t4=e.sent,e.t3.push.call(e.t3,e.t4);case 35:e.next=28;break;case 37:e.next=42;break;case 39:e.prev=39,e.t5=e.catch(26),y.e(e.t5);case 42:return e.prev=42,y.f(),e.finish(42);case 45:return O=o.length||l.length||p.length?{adds:o,updates:l,deletes:p}:null,m=this._getLayerRequestOptions({method:"post",query:{adds:a.length?JSON.stringify(a):null,updates:s.length?JSON.stringify(s):null,deletes:i.length?i.join(","):null,gdbVersion:null==r?void 0:r.gdbVersion,rollbackOnFailure:null==r?void 0:r.rollbackOnFailureEnabled,useGlobalIds:null==r?void 0:r.globalIdUsed,attachments:O&&JSON.stringify(O)}}),e.next=49,Object(R.default)(this.layer.parsedUrl.path+"/applyEdits",m);case 49:return j=e.sent,e.abrupt("return",this._createEditsResult(j));case 51:case"end":return e.stop()}}),e,this,[[6,19,22,25],[26,39,42,45]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteAttachments",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){var a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return a=t.attributes[this.layer.objectIdField],n=this.layer.parsedUrl.path+"/"+a+"/deleteAttachments",e.prev=3,e.next=6,Object(R.default)(n,this._getLayerRequestOptions({query:{attachmentIds:r.join(",")},method:"post"}));case 6:return e.abrupt("return",e.sent.data.deleteAttachmentResults.map(this._createFeatureEditResult));case 9:throw e.prev=9,e.t0=e.catch(3),this._createAttachmentErrorResult(a,e.t0);case 12:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchRecomputedExtents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.signal;return this.load({signal:r}).then(Object(i.a)(c.a.mark((function r(){var n,u,s,i,o,l,p,f,d,h,y;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e._getLayerRequestOptions(Object(a.a)(Object(a.a)({},t),{},{query:{returnUpdates:!0}})),u=e.layer,s=u.layerId,i=u.url,r.next=6,Object(R.default)("".concat(i,"/").concat(s),n);case 6:return o=r.sent,l=o.data,p=l.id,f=l.extent,d=l.fullExtent,h=l.timeExtent,y=f||d,r.abrupt("return",{id:p,fullExtent:y&&k.a.fromJSON(y),timeExtent:h&&F.a.fromJSON({start:h[0],end:h[1]})});case 14:case"end":return r.stop()}}),r)}))))}},{key:"queryAttachments",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var r,a,u,s,i,o,l,p,f,d,h=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>1&&void 0!==h[1]?h[1]:{},a=this.layer.parsedUrl,u=a.path,e.next=4,this.load();case 4:if(s=this._getLayerRequestOptions(r),this.layer.get("capabilities.operations.supportsQueryAttachments")){e.next=10;break}i=t.objectIds,o=[],l=Object(n.a)(i);try{for(l.s();!(p=l.n()).done;)f=p.value,d=u+"/"+f+"/attachments",o.push(Object(R.default)(d,s))}catch(c){l.e(c)}finally{l.f()}return e.abrupt("return",Object(x.b)(o).then((function(e){return i.map((function(t,r){return{parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}}))})).then((function(e){return Object(I.b)(e,u)})));case 10:return e.abrupt("return",this.queryTask.executeAttachmentQuery(t,s));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeatures",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.execute(t,Object(a.a)(Object(a.a)({},r),{},{query:Object(a.a)(Object(a.a)({},this.layer.customParameters),null==r?void 0:r.query)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeJSON(t,Object(a.a)(Object(a.a)({},r),{},{query:Object(a.a)(Object(a.a)({},this.layer.customParameters),null==r?void 0:r.query)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryObjectIds",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForIds(t,Object(a.a)(Object(a.a)({},r),{},{query:Object(a.a)(Object(a.a)({},this.layer.customParameters),null==r?void 0:r.query)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForCount(t,Object(a.a)(Object(a.a)({},r),{},{query:Object(a.a)(Object(a.a)({},this.layer.customParameters),null==r?void 0:r.query)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryExtent",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeForExtent(t,Object(a.a)(Object(a.a)({},r),{},{query:Object(a.a)(Object(a.a)({},this.layer.customParameters),null==r?void 0:r.query)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeatures",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeRelationshipQuery(t,Object(a.a)(Object(a.a)({},r),{},{query:Object(a.a)(Object(a.a)({},this.layer.customParameters),null==r?void 0:r.query)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryRelatedFeaturesCount",value:function(){var e=Object(i.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:return e.abrupt("return",this.queryTask.executeRelationshipQueryForCount(t,Object(a.a)(Object(a.a)({},r),{},{query:Object(a.a)(Object(a.a)({},this.layer.customParameters),null==r?void 0:r.query)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchService",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var r,a,n,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.layer.sourceJSON){e.next=7;break}return e.next=4,Object(R.default)(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:Object(h.a)("featurelayer-advanced-symbols")?{returnAdvancedSymbols:!0}:{},signal:t}));case 4:a=e.sent,n=a.data,r=n;case 7:if(this.sourceJSON=this._patchServiceJSON(r),u=r.type,A.has(u)){e.next=11;break}throw new j.a("feature-layer-source:unsupported-type",'Source type "'.concat(u,'" is not supported'));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_patchServiceJSON",value:function(e){var t;if("Table"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){var r=Object(S.c)(e.geometryType).renderer;Object(b.c)("drawingInfo.renderer",r,e)}return e}},{key:"_serializeFeature",value:function(e){var t=e.geometry,r=e.attributes;return Object(v.f)(t)?{attributes:r}:"mesh"===t.type||"extent"===t.type?null:{geometry:t.toJSON(),attributes:r}}},{key:"_serializeAttachment",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var r,a,n,u,s,o,l,p,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.feature,a=t.attachment,n=a.globalId,u=a.name,s=a.contentType,o=a.data,l=a.uploadId,p={globalId:n,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null},r&&(p.parentGlobalId="attributes"in r?r.attributes&&r.attributes[this.layer.globalIdField]:r.globalId),!l){e.next=5;break}p.uploadId=l,e.next=10;break;case 5:if(!o){e.next=10;break}return e.next=8,function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=2;break}return e.abrupt("return",Object(g.i)(t)||{data:t});case 2:return e.abrupt("return",Object(x.c)((function(e,r){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){return e(Object(g.i)(a.result))},a.onerror=function(e){return r(e)}})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 8:f=e.sent,p.contentType=f.mediaType,p.data=f.data,o instanceof File&&(p.name=o.name);case 10:return e.abrupt("return",(u&&(p.name=u),s&&(p.contentType=s),p));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getFeatureIds",value:function(e){var t=e[0];return t?"objectId"in t?this._getIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}},{key:"_getIdsFromFeatures",value:function(e){var t=this.layer.objectIdField;return e.map((function(e){return e.attributes&&e.attributes[t]}))}},{key:"_getIdsFromFeatureIdentifier",value:function(e){return e.map((function(e){return e.objectId}))}},{key:"_createEditsResult",value:function(e){var t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}},{key:"_createFeatureEditResult",value:function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new j.a("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}},{key:"_createAttachmentErrorResult",value:function(e,t){var r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new j.a("feature-layer-source:attachment-failure",r,{code:a})}}},{key:"_getFormDataForAttachment",value:function(e,t){var r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(var a in t){var n=t[a];null!=n&&(r.set?r.set(a,n):r.append(a,n))}return r}},{key:"_getLayerRequestOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.layer,r=t.parsedUrl,n=t.gdbVersion,u=t.dynamicDataSource;return Object(a.a)(Object(a.a)({},e),{},{query:Object(y.c)(Object(a.a)(Object(a.a)(Object(a.a)({gdbVersion:n,layer:u?JSON.stringify({source:u}):void 0},r.query),{},{f:"json"},this.layer.customParameters),null==e?void 0:e.query)),responseType:"json"})}},{key:"queryTask",get:function(){var e=this.layer,t=e.capabilities.query.supportsFormatPBF,r=e.parsedUrl,a=e.dynamicDataSource,n=e.gdbVersion,u=e.spatialReference,s=e.fieldsIndex,c=Object(h.a)("featurelayer-pbf")&&t?"pbf":"json";return new _.a({url:r.path,format:c,fieldsIndex:s,dynamicDataSource:a,gdbVersion:n,sourceSpatialReference:u})}}]),r}(w.a);Object(d.a)([Object(O.b)()],J.prototype,"type",void 0),Object(d.a)([Object(O.b)({constructOnly:!0})],J.prototype,"layer",void 0),Object(d.a)([Object(O.b)({readOnly:!0,dependsOn:["layer.parsedUrl","layer.gdbVersion","layer.dynamicDataSource","layer.fieldsIndex"]})],J.prototype,"queryTask",null);var N=J=Object(d.a)([Object(m.a)("esri.layers.graphics.sources.FeatureLayerSource")],J);t.default=N}}]);
//# sourceMappingURL=44.d2dca89e.chunk.js.map