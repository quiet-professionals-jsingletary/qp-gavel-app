{"version":3,"sources":["../node_modules/@arcgis/core/chunks/quatf32.js","../node_modules/@arcgis/core/views/3d/layers/i3s/LEPCC.js","../node_modules/@arcgis/core/views/3d/layers/i3s/I3SBinaryReader.js","../node_modules/@arcgis/core/views/3d/layers/i3s/PointCloudWorkerUtil.js","../node_modules/@arcgis/core/views/3d/layers/PointCloudWorker.js"],"names":["r","Float32Array","Object","freeze","__proto__","create","clone","n","fromValues","e","t","a","createView","c","i","identifier","String","fromCharCode","apply","Uint8Array","version","getUint16","checksum","getUint32","L","o","B","length","push","DataView","getUint8","s","l","d","Math","ceil","u","w","h","f","g","getLogger","byteOffset","byteCount","fields","valueType","type","I","property","m","BYTES_PER_ELEMENT","count","valuesPerElement","b","error","expectedSize","actualSize","p","position","normal","color","uv0","region","C","encoding","sizeLo","sizeHi","colorMapCount","lookupMethod","compressionMethod","pow","byteLength","slice","scaleFactor","bitsPerPoint","reserved","Uint16Array","attributeByteCounts","warn","ordering","hasOwnProperty","header","entries","A","attributeValues","objectIds","Float32","Float64","Float64Array","UInt8","Int8","Int8Array","UInt16","Int16","Int16Array","UInt32","Uint32Array","Int32","Int32Array","getFloat32","getFloat64","getInt8","getInt16","getInt32","isDraco","vertexAttributes","vertexCount","faceCount","faces","featureCount","featureAttributes","featureAttributeOrder","offsetX","offsetY","offsetZ","scaleX","scaleY","scaleZ","z","minX","minY","minZ","maxX","maxY","maxZ","errorX","errorY","errorZ","F","k","v","X","min","result","attributeInfo","useElevation","storageInfo","buffer","abs","this","_transform","points","rgb","pointIdFilterMap","attributes","values","transferList","schema","geometryBuffer","primaryAttributeData","modulationAttributeData","rendererJSON","isRGBRenderer","fromJSON","colorUniqueValueInfos","fieldTransformType","indexOf","stops","value","colorClassBreakInfos","minValue","maxValue","colorModulation","rendererInfo","filterInfo","filterAttributesData","map","filterJSON","mode","requiredSetBits","requiredClearBits","includedReturns","userAttributesData","_applyElevationOffsetInPlace","elevationOffset","_transformCoordinates","obb","inSR","outSR","Error","center","quaternion","halfSize","max"],"mappings":"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","file":"static/js/125.2cbdacc8.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction r(){const r=new Float32Array(4);return r[3]=1,r}function n(r){const n=new Float32Array(4);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n}function e(r,n,e,t){const a=new Float32Array(4);return a[0]=r,a[1]=n,a[2]=e,a[3]=t,a}function t(r,n){return new Float32Array(r,n,4)}var a=Object.freeze({__proto__:null,create:r,clone:n,fromValues:e,createView:t});export{n as a,r as b,t as c,e as f,a as q};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";const t=0,o=10,r=10,n=12,i=16;function c(e,i,c){return{identifier:String.fromCharCode.apply(null,new Uint8Array(e,c+t,o)),version:i.getUint16(c+r,true),checksum:i.getUint32(c+n,true)}}const s=0,l=4,d=8,a=16,u=24,w=32,h=40,f=48,g=56,p=64,U=72,m=80,M=84,y=88;function z(t){const o=new DataView(t,0);let r=0;const{identifier:n,version:z}=c(t,o,r);if(r+=i,\"LEPCC     \"!==n)throw new e(\"lepcc-decode-error\",\"Bad identifier\");if(z>1)throw new e(\"lepcc-decode-error\",\"Unknown version\");const B=function(e,t){return{sizeLo:e.getUint32(t+s,!0),sizeHi:e.getUint32(t+l,!0),minX:e.getFloat64(t+d,!0),minY:e.getFloat64(t+a,!0),minZ:e.getFloat64(t+u,!0),maxX:e.getFloat64(t+w,!0),maxY:e.getFloat64(t+h,!0),maxZ:e.getFloat64(t+f,!0),errorX:e.getFloat64(t+g,!0),errorY:e.getFloat64(t+p,!0),errorZ:e.getFloat64(t+U,!0),count:e.getUint32(t+m,!0),reserved:e.getUint32(t+M,!0)}}(o,r);r+=y;if(B.sizeHi*Math.pow(2,32)+B.sizeLo!==t.byteLength)throw new e(\"lepcc-decode-error\",\"Bad size\");const F=new Float64Array(3*B.count),b=[],C=[],A=[],k=[];if(r=L(t,r,b),r=L(t,r,C),r=L(t,r,A),r=L(t,r,k),r!==t.byteLength)throw new e(\"lepcc-decode-error\",\"Bad length\");let v=0,X=0;for(let e=0;e<b.length;e++){X+=b[e];let t=0;for(let o=0;o<C[e];o++){t+=A[v];const e=k[v];F[3*v]=Math.min(B.maxX,B.minX+2*B.errorX*t),F[3*v+1]=Math.min(B.maxY,B.minY+2*B.errorY*X),F[3*v+2]=Math.min(B.maxZ,B.minZ+2*B.errorZ*e),v++}}return{errorX:B.errorX,errorY:B.errorY,errorZ:B.errorZ,result:F}}function L(e,t,o){const r=[];t=B(e,t,r);const n=[];for(let i=0;i<r.length;i++){n.length=0,t=B(e,t,n);for(let e=0;e<n.length;e++)o.push(n[e]+r[i])}return t}function B(t,o,r){const n=new DataView(t,o),i=n.getUint8(0),c=31&i,s=!!(32&i),l=(192&i)>>6;let d=0;if(0===l)d=n.getUint32(1,true),o+=5;else if(1===l)d=n.getUint16(1,true),o+=3;else{if(2!==l)throw new e(\"lepcc-decode-error\",\"Bad count type\");d=n.getUint8(1),o+=2}if(s)throw new e(\"lepcc-decode-error\",\"LUT not implemented\");const a=Math.ceil(d*c/8),u=new Uint8Array(t,o,a);let w=0,h=0,f=0;const g=-1>>>32-c;for(let e=0;e<d;e++){for(;h<c;)w|=u[f]<<h,h+=8,f+=1;r[e]=w&g,w>>>=c,h-=c,h+c>32&&(w|=u[f-1]>>8-h)}return o+f}const F=0,b=4,C=8,A=12,k=14,v=15,X=16;function Y(t){const o=new DataView(t,0);let r=0;const{identifier:n,version:s}=c(t,o,r);if(r+=i,\"ClusterRGB\"!==n)throw new e(\"lepcc-decode-error\",\"Bad identifier\");if(s>1)throw new e(\"lepcc-decode-error\",\"Unknown version\");const l=function(e,t){return{sizeLo:e.getUint32(t+F,!0),sizeHi:e.getUint32(t+b,!0),count:e.getUint32(t+C,!0),colorMapCount:e.getUint16(t+A,!0),lookupMethod:e.getUint8(t+k),compressionMethod:e.getUint8(t+v)}}(o,r);r+=X;if(l.sizeHi*Math.pow(2,32)+l.sizeLo!==t.byteLength)throw new e(\"lepcc-decode-error\",\"Bad size\");if((2===l.lookupMethod||1===l.lookupMethod)&&0===l.compressionMethod){if(3*l.colorMapCount+l.count+r!==t.byteLength||l.colorMapCount>256)throw new e(\"lepcc-decode-error\",\"Bad count\");const o=new Uint8Array(t,r,3*l.colorMapCount),n=new Uint8Array(t,r+3*l.colorMapCount,l.count),i=new Uint8Array(3*l.count);for(let e=0;e<l.count;e++){const t=n[e];i[3*e]=o[3*t],i[3*e+1]=o[3*t+1],i[3*e+2]=o[3*t+2]}return i}if(0===l.lookupMethod&&0===l.compressionMethod){if(3*l.count+r!==t.byteLength||0!==l.colorMapCount)throw new e(\"lepcc-decode-error\",\"Bad count\");return new Uint8Array(t,r).slice()}if(l.lookupMethod<=2&&1===l.compressionMethod){if(r+3!==t.byteLength||1!==l.colorMapCount)throw new e(\"lepcc-decode-error\",\"Bad count\");const n=o.getUint8(r),i=o.getUint8(r+1),c=o.getUint8(r+2),s=new Uint8Array(3*l.count);for(let e=0;e<l.count;e++)s[3*e]=n,s[3*e+1]=i,s[3*e+2]=c;return s}throw new e(\"lepcc-decode-error\",\"Bad method \"+l.lookupMethod+\",\"+l.compressionMethod)}const Z=0,x=4,P=8,H=12,D=14,V=15,E=16;function j(t){const o=new DataView(t,0);let r=0;const{identifier:n,version:s}=c(t,o,r);if(r+=i,\"Intensity \"!==n)throw new e(\"lepcc-decode-error\",\"Bad identifier\");if(s>1)throw new e(\"lepcc-decode-error\",\"Unknown version\");const l=function(e,t){return{sizeLo:e.getUint32(t+Z,!0),sizeHi:e.getUint32(t+x,!0),count:e.getUint32(t+P,!0),scaleFactor:e.getUint16(t+H,!0),bitsPerPoint:e.getUint8(t+D),reserved:e.getUint8(t+V)}}(o,r);r+=E;if(l.sizeHi*Math.pow(2,32)+l.sizeLo!==t.byteLength)throw new e(\"lepcc-decode-error\",\"Bad size\");const d=new Uint16Array(l.count);if(8===l.bitsPerPoint){if(l.count+r!==t.byteLength)throw new e(\"lepcc-decode-error\",\"Bad size\");const o=new Uint8Array(t,r,l.count);for(let e=0;e<l.count;e++)d[e]=o[e]*l.scaleFactor}else if(16===l.bitsPerPoint){if(2*l.count+r!==t.byteLength)throw new e(\"lepcc-decode-error\",\"Bad size\");const o=new Uint16Array(t,r,l.count);for(let e=0;e<l.count;e++)d[e]=o[e]*l.scaleFactor}else{const o=[];if(B(t,r,o)!==t.byteLength)throw new e(\"lepcc-decode-error\",\"Bad size\");for(let e=0;e<l.count;e++)d[e]=o[e]*l.scaleFactor}return d}export{j as decodeIntensity,Y as decodeRGB,z as decodeXYZ};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{clone as e}from\"../../../../core/lang.js\";import t from\"../../../../core/Logger.js\";import n from\"../../../../core/Error.js\";import{decodeRGB as r,decodeIntensity as o}from\"./LEPCC.js\";const i=t.getLogger(\"esri.views.3d.layers.i3s.I3SBinaryReader\");function u(e,t,r){let o=\"\",i=0;for(;i<r;){const u=e[t+i];if(u<128)o+=String.fromCharCode(u),i++;else if(u>=192&&u<224){if(i+1>=r)throw new n(\"utf8-decode-error\",\"UTF-8 Decode failed. Two byte character was truncated.\");const a=(31&u)<<6|63&e[t+i+1];o+=String.fromCharCode(a),i+=2}else if(u>=224&&u<240){if(i+2>=r)throw new n(\"utf8-decode-error\",\"UTF-8 Decode failed. Multi byte character was truncated.\");const a=(15&u)<<12|(63&e[t+i+1])<<6|63&e[t+i+2];o+=String.fromCharCode(a),i+=3}else{if(!(u>=240&&u<248))throw new n(\"utf8-decode-error\",\"UTF-8 Decode failed. Invalid multi byte sequence.\");{if(i+3>=r)throw new n(\"utf8-decode-error\",\"UTF-8 Decode failed. Multi byte character was truncated.\");const a=(7&u)<<18|(63&e[t+i+1])<<12|(63&e[t+i+2])<<6|63&e[t+i+3];if(a>=65536){const e=55296+(a-65536>>10),t=56320+(1023&a);o+=String.fromCharCode(e,t)}else o+=String.fromCharCode(a);i+=4}}}return o}function a(e,t){const n={byteOffset:0,byteCount:0,fields:Object.create(null)};let r=0;for(let o=0;o<t.length;o++){const i=t[o],u=i.valueType||i.type,a=I[u];n.fields[i.property]=a(e,r),r+=m[u].BYTES_PER_ELEMENT}return n.byteCount=r,n}function s(e,t,r){const o=[];let i,a,s=0;for(a=0;a<e;a+=1){if(i=t[a],i>0){if(o.push(u(r,s,i-1)),0!==r[s+i-1])throw new n(\"string-array-error\",\"Invalid string array: missing null termination.\")}else o.push(null);s+=i}return o}function c(e,t){return new(0,m[t.valueType])(e,t.byteOffset,t.count*t.valuesPerElement)}function f(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}function l(t,r,o){const i=null!=r.header?a(t,r.header):{byteOffset:0,byteCount:0,fields:{count:o}},u={header:i,byteOffset:i.byteCount,byteCount:0,entries:Object.create(null)};let s=i.byteCount;for(let t=0;t<r.ordering.length;t++){const o=r.ordering[t],a=e(r[o]);if(a.count=i.fields.count,\"String\"===a.valueType){if(a.byteOffset=s,a.byteCount=i.fields[o+\"ByteCount\"],\"UTF-8\"!==a.encoding)throw new n(\"unsupported-encoding\",\"Unsupported String encoding.\",{encoding:a.encoding})}else{if(!h(a.valueType))throw new n(\"unsupported-value-type\",\"Unsupported binary valueType\",{valueType:a.valueType});{const e=A(a.valueType);s+=s%e!=0?e-s%e:0,a.byteOffset=s,a.byteCount=e*a.valuesPerElement*a.count}}s+=a.byteCount,u.entries[o]=a}return u.byteCount=s-u.byteOffset,u}function b(e,t,r){if(t!==e&&i.error(`Invalid ${r} buffer size\\n expected: ${e}, actual: ${t})`),t<e)throw new n(\"buffer-too-small\",\"Binary buffer is too small\",{expectedSize:e,actualSize:t})}function d(e){return{isDraco:!1,isLegacy:!1,color:null!=e.color,normal:null!=e.normal,uv0:null!=e.uv0,uvRegion:null!=e.uvRegion,featureIndex:null!=e.faceRange&&null!=e.featureId}}function y(e,t){const n=a(e,t&&t.header);let r=n.byteCount;const o={isDraco:!1,header:n,byteOffset:n.byteCount,byteCount:0,vertexAttributes:{}},i=n.fields,u=null!=i.vertexCount?i.vertexCount:i.count;for(const e of t.ordering){if(!t.vertexAttributes[e])continue;const n={...t.vertexAttributes[e],byteOffset:r,count:u},i=p[e]?p[e]:\"_\"+e;o.vertexAttributes[i]=n,r+=A(n.valueType)*n.valuesPerElement*u}const s=i.faceCount;if(t.faces&&s){o.faces={};for(const e of t.ordering){if(!t.faces[e])continue;const n={...t.faces[e],byteOffset:r,count:s};o.faces[e]=n,r+=A(n.valueType)*n.valuesPerElement*s}}const c=i.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&c){o.featureAttributes={};for(const e of t.featureAttributeOrder){if(!t.featureAttributes[e])continue;const n={...t.featureAttributes[e],byteOffset:r,count:c};o.featureAttributes[e]=n;r+=(\"UInt64\"===n.valueType?8:A(n.valueType))*n.valuesPerElement*c}}return b(r,e.byteLength,\"geometry\"),o.byteCount=r-o.byteOffset,o}function g(e,t){return!(!e||!e.compressedAttributes||\"draco\"!==e.compressedAttributes.encoding)?v(e.compressedAttributes.attributes):e?d(e):w(t)}function w(e){const t={isDraco:!1,isLegacy:!0,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const n of e.ordering)if(e.vertexAttributes[n])switch(n){case\"position\":break;case\"normal\":t.normal=!0;break;case\"color\":t.color=!0;break;case\"uv0\":t.uv0=!0;break;case\"region\":t.uvRegion=!0}return e.featureAttributes&&e.featureAttributeOrder&&(t.featureIndex=!0),t}function v(e){const t={isDraco:!0,isLegacy:!1,color:!1,normal:!1,uv0:!1,uvRegion:!1,featureIndex:!1};for(const n of e)switch(n){case\"position\":break;case\"normal\":t.normal=!0;break;case\"uv0\":t.uv0=!0;break;case\"color\":t.color=!0;break;case\"uv-region\":t.uvRegion=!0;break;case\"feature-index\":t.featureIndex=!0}return t}const p={position:\"position\",normal:\"normal\",color:\"color\",uv0:\"uv0\",region:\"uvRegion\"};function C(e,t,u){if(\"lepcc-rgb\"===e.encoding)return r(t);if(\"lepcc-intensity\"===e.encoding)return o(t);if(null!=e.encoding&&\"\"!==e.encoding)throw new n(\"unknown-attribute-storage-info-encoding\",\"Unknown Attribute Storage Info Encoding\");e[\"attributeByteCounts \"]&&!e.attributeByteCounts&&(i.warn(\"Warning: Trailing space in 'attributeByteCounts '.\"),e.attributeByteCounts=e[\"attributeByteCounts \"]),\"ObjectIds\"===e.ordering[0]&&e.hasOwnProperty(\"objectIds\")&&(i.warn(\"Warning: Case error in objectIds\"),e.ordering[0]=\"objectIds\");const a=l(t,e,u);b(a.byteOffset+a.byteCount,t.byteLength,\"attribute\");const d=a.entries.attributeValues||a.entries.objectIds;if(d){if(\"String\"===d.valueType){const e=a.entries.attributeByteCounts,n=c(t,e),r=f(t,d);return s(e.count,n,r)}return c(t,d)}throw new n(\"bad-attribute-storage-info\",\"Bad attributeStorageInfo specification.\")}const m={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},I={Float32:(e,t)=>new DataView(e,0).getFloat32(t,!0),Float64:(e,t)=>new DataView(e,0).getFloat64(t,!0),UInt8:(e,t)=>new DataView(e,0).getUint8(t),Int8:(e,t)=>new DataView(e,0).getInt8(t),UInt16:(e,t)=>new DataView(e,0).getUint16(t,!0),Int16:(e,t)=>new DataView(e,0).getInt16(t,!0),UInt32:(e,t)=>new DataView(e,0).getUint32(t,!0),Int32:(e,t)=>new DataView(e,0).getInt32(t,!0)};function h(e){return m.hasOwnProperty(e)}function A(e){return h(e)?m[e].BYTES_PER_ELEMENT:0}export{l as createAttributeDataIndex,g as createGeometryDescriptor,v as createGeometryDescriptorForDraco,d as createGeometryDescriptorFromDefinition,w as createGeometryDescriptorFromSchema,y as createGeometryIndexFromSchema,f as createRawView,c as createTypedView,A as getBytesPerValue,h as isValueType,C as readBinaryAttribute,a as readHeader,s as readStringArray,I as valueType2ArrayBufferReader,m as valueType2TypedArrayClassMap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as o}from\"../../../../core/maybe.js\";import r from\"../../../../renderers/PointCloudClassBreaksRenderer.js\";import t from\"../../../../renderers/PointCloudStretchRenderer.js\";import n from\"../../../../renderers/PointCloudUniqueValueRenderer.js\";import{decodeXYZ as l}from\"./LEPCC.js\";import{createGeometryIndexFromSchema as i,createTypedView as s,readBinaryAttribute as f}from\"./I3SBinaryReader.js\";function u(e,o,l,i){const{rendererJSON:s,isRGBRenderer:f}=e;let u=null,c=null;if(o&&f)u=o;else if(o&&\"pointCloudUniqueValueRenderer\"===s.type){c=n.fromJSON(s);const e=c.colorUniqueValueInfos;u=new Uint8Array(3*i);const r=p(c.fieldTransformType);for(let t=0;t<i;t++){const n=(r?r(o[t]):o[t])+\"\";for(let o=0;o<e.length;o++)if(e[o].values.indexOf(n)>=0){u[3*t]=e[o].color.r,u[3*t+1]=e[o].color.g,u[3*t+2]=e[o].color.b;break}}}else if(o&&\"pointCloudStretchRenderer\"===s.type){c=t.fromJSON(s);const e=c.stops;u=new Uint8Array(3*i);const r=p(c.fieldTransformType);for(let t=0;t<i;t++){const n=r?r(o[t]):o[t],l=e.length-1;if(n<e[0].value)u[3*t]=e[0].color.r,u[3*t+1]=e[0].color.g,u[3*t+2]=e[0].color.b;else if(n>=e[l].value)u[3*t]=e[l].color.r,u[3*t+1]=e[l].color.g,u[3*t+2]=e[l].color.b;else for(let o=1;o<e.length;o++)if(n<e[o].value){const r=(n-e[o-1].value)/(e[o].value-e[o-1].value);u[3*t]=e[o].color.r*r+e[o-1].color.r*(1-r),u[3*t+1]=e[o].color.g*r+e[o-1].color.g*(1-r),u[3*t+2]=e[o].color.b*r+e[o-1].color.b*(1-r);break}}}else if(o&&\"pointCloudClassBreaksRenderer\"===s.type){c=r.fromJSON(s);const e=c.colorClassBreakInfos;u=new Uint8Array(3*i);const t=p(c.fieldTransformType);for(let r=0;r<i;r++){const n=t?t(o[r]):o[r];for(let o=0;o<e.length;o++)if(n>=e[o].minValue&&n<=e[o].maxValue){u[3*r]=e[o].color.r,u[3*r+1]=e[o].color.g,u[3*r+2]=e[o].color.b;break}}}else{u=new Uint8Array(3*i);for(let e=0;e<u.length;e++)u[e]=255}if(l&&c&&c.colorModulation){const e=c.colorModulation.minValue,o=c.colorModulation.maxValue,r=.3;for(let t=0;t<i;t++){const n=l[t],i=n>=o?1:n<=e?r:r+(1-r)*(n-e)/(o-e);u[3*t]=i*u[3*t],u[3*t+1]=i*u[3*t+1],u[3*t+2]=i*u[3*t+2]}}return u}function c(o,r){if(null==o.encoding||\"\"===o.encoding){const t=i(r,o);if(e(t.vertexAttributes.position))return;const n=s(r,t.vertexAttributes.position),l=t.header.fields,f=[l.offsetX,l.offsetY,l.offsetZ],u=[l.scaleX,l.scaleY,l.scaleZ],c=n.length/3,a=new Float64Array(3*c);for(let e=0;e<c;e++)a[3*e]=n[3*e]*u[0]+f[0],a[3*e+1]=n[3*e+1]*u[1]+f[1],a[3*e+2]=n[3*e+2]*u[2]+f[2];return a}if(\"lepcc-xyz\"===o.encoding)return l(r).result}function a(e,r,t){return o(e)&&e.attributeInfo.useElevation?d(r,t):o(e)?f(e.attributeInfo.storageInfo,e.buffer,t):null}function d(e,o){const r=new Float64Array(o);for(let t=0;t<o;t++)r[t]=e[3*t+2];return r}function m(e,o,r,t,n){const l=e.length/3;let i=0;for(let s=0;s<l;s++){let l=!0;for(let e=0;e<t.length&&l;e++){const{filterJSON:o}=t[e],r=n[e].values[s];switch(o.type){case\"pointCloudValueFilter\":{const e=\"exclude\"===o.mode;-1!==o.values.indexOf(r)===e&&(l=!1);break}case\"pointCloudBitfieldFilter\":{const e=b(o.requiredSetBits),t=b(o.requiredClearBits);(r&e)===e&&0==(r&t)||(l=!1);break}case\"pointCloudReturnFilter\":{const e=15&r,t=r>>>4&15,n=t>1,i=1===e,s=e===t;let f=!1;for(const e of o.includedReturns)if(\"last\"===e&&s||\"firstOfMany\"===e&&i&&n||\"lastOfMany\"===e&&s&&n||\"single\"===e&&!n){f=!0;break}f||(l=!1);break}}}l&&(r[i]=s,e[3*i]=e[3*s],e[3*i+1]=e[3*s+1],e[3*i+2]=e[3*s+2],o[3*i]=o[3*s],o[3*i+1]=o[3*s+1],o[3*i+2]=o[3*s+2],i++)}return i}function p(e){return null==e||\"none\"===e?null:\"low-four-bit\"===e?e=>15&e:\"high-four-bit\"===e?e=>(240&e)>>4:\"absolute-value\"===e?e=>Math.abs(e):\"modulo-ten\"===e?e=>e%10:null}function b(e){let o=0;for(const r of e||[])o|=1<<r;return o}export{d as elevationFromPositions,u as evaluateRenderer,m as filterInPlace,a as getAttributeValues,c as readGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isArrayBuffer as t}from\"../../../core/typedArrayUtil.js\";import{isSome as r}from\"../../../core/maybe.js\";import{resolve as e}from\"../../../core/promiseUtils.js\";import a from\"../../../geometry/SpatialReference.js\";import{q as o}from\"../../../chunks/vec3.js\";import{projectBuffer as f}from\"../../../geometry/projection.js\";import{c as i}from\"../../../chunks/quat.js\";import{f as s,c as n}from\"../../../chunks/vec3f32.js\";import{b as u}from\"../../../chunks/quatf32.js\";import{readGeometry as l,getAttributeValues as m,evaluateRenderer as b,filterInPlace as p}from\"./i3s/PointCloudWorkerUtil.js\";class c{transform(a){const o=this._transform(a),f=[o.points.buffer,o.rgb.buffer];r(o.pointIdFilterMap)&&f.push(o.pointIdFilterMap.buffer);for(const r of o.attributes)\"buffer\"in r.values&&t(r.values.buffer)&&r.values.buffer!==o.rgb.buffer&&f.push(r.values.buffer);return e({result:o,transferList:f})}_transform(t){const e=l(t.schema,t.geometryBuffer);let o=e.length/3,f=null;const i=[],s=m(t.primaryAttributeData,e,o);r(t.primaryAttributeData)&&s&&i.push({attributeInfo:t.primaryAttributeData.attributeInfo,values:s});const n=m(t.modulationAttributeData,e,o);r(t.modulationAttributeData)&&n&&i.push({attributeInfo:t.modulationAttributeData.attributeInfo,values:n});let u=b(t.rendererInfo,s,n,o);if(t.filterInfo&&t.filterInfo.length>0&&r(t.filterAttributesData)){const r=t.filterAttributesData.map((t=>{const r=m(t,e,o),a={attributeInfo:t.attributeInfo,values:r};return i.push(a),a}));f=new Uint32Array(o),o=p(e,u,f,t.filterInfo,r)}for(const r of t.userAttributesData){const t=m(r,e,o);i.push({attributeInfo:r.attributeInfo,values:t})}3*o<u.length&&(u=new Uint8Array(u.buffer.slice(0,3*o))),this._applyElevationOffsetInPlace(e,o,t.elevationOffset);const c=this._transformCoordinates(e,o,t.obb,a.fromJSON(t.inSR),a.fromJSON(t.outSR));return{obb:t.obb,points:c,rgb:u,attributes:i,pointIdFilterMap:f}}_transformCoordinates(t,r,e,a,u){if(!f(t,a,0,t,u,0,r))throw Error(\"Can't reproject\");const l=s(e.center[0],e.center[1],e.center[2]),m=n(),b=n();i(h,e.quaternion);const p=new Float32Array(3*r);for(let a=0;a<r;a++)m[0]=t[3*a]-l[0],m[1]=t[3*a+1]-l[1],m[2]=t[3*a+2]-l[2],o(b,m,h),e.halfSize[0]=Math.max(e.halfSize[0],Math.abs(b[0])),e.halfSize[1]=Math.max(e.halfSize[1],Math.abs(b[1])),e.halfSize[2]=Math.max(e.halfSize[2],Math.abs(b[2])),p[3*a]=m[0],p[3*a+1]=m[1],p[3*a+2]=m[2];return p}_applyElevationOffsetInPlace(t,r,e){if(0!==e)for(let a=0;a<r;a++)t[3*a+2]+=e}}const h=u();function I(){return new c}export default I;\n"],"sourceRoot":""}